(function(){var g={};
(function(window){var l,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function r(a,b){function c(){}c.prototype=b.prototype;a.bf=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ze=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function ba(){};n("shaka.log.Level",{NONE:0,ERROR:1,Ye:2,Ve:3,Ue:4,We:5,Xe:6});function s(){}n("shaka.log.error",s);function t(){}n("shaka.log.warning",t);function v(){}n("shaka.log.info",v);function w(){}n("shaka.log.debug",w);function x(){}n("shaka.log.v1",x);function ca(){}n("shaka.log.v2",ca);
n("shaka.log.setLevel",function(a){function b(){}s=1<=a?console.error.bind(console):b;t=2<=a?console.warn.bind(console):b;v=3<=a?console.info.bind(console):b;w=4<=a?console.log.bind(console):b;x=5<=a?console.debug.bind(console):b;ca=6<=a?console.debug.bind(console):b});function da(a){ea[a]={Va:fa(),end:NaN}}function ga(a){var b=ea[a];b&&(b.end=fa(),w(a+": "+(b.end-b.Va).toFixed(3)+"ms"))}function ha(a){return(a=ea[a])&&a.end?a.end-a.Va:NaN}var fa=window.performance?window.performance.now.bind(window.performance):Date.now,ea={};function ia(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ja(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ka(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function la(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",la);function ma(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=na)}n("shaka.polyfill.CustomEvent.install",ma);function na(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function oa(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
pa);document.addEventListener("webkitfullscreenerror",pa);document.addEventListener("mozfullscreenchange",pa);document.addEventListener("mozfullscreenerror",pa);document.addEventListener("MSFullscreenChange",pa);document.addEventListener("MSFullscreenError",pa)}n("shaka.polyfill.Fullscreen.install",oa);function pa(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function qa(){w("PatchedMediaKeys.nop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function ra(a){w("PatchedMediaKeys.nop.setMediaKeys");return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function sa(){throw new TypeError("Illegal constructor.");}sa.prototype.createSession=function(){};function ta(){throw new TypeError("Illegal constructor.");}ta.prototype.getConfiguration=function(){};
ta.prototype.createMediaKeys=function(){};function ua(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){d||(d=!0,c(e))}}function va(a,b,c,d){this.ae="function"===typeof a?a:null;this.ne="function"===typeof b?b:null;this.resolve=c;this.reject=d}function wa(){for(var a=0,b=this.Mb.length;a<b;a++)xa.call(this,this.Mb[a]);this.Mb=null}function ya(a){this.qb=!1;this.Nb=a;wa.call(this)}
function za(a){try{if(a===this)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"===typeof a||"function"===typeof a)){var b=a.then;if("function"===typeof b){ua(Aa(b,a),Aa(za,this),Aa(ya,this));return}}this.qb=!0;this.Nb=a;wa.call(this)}catch(c){ya.call(this,c)}}function xa(a){var b=this;null===this.qb?this.Mb.push(a):Ba(function(){var c=b.qb?a.ae:a.ne;if(null===c)(b.qb?a.resolve:a.reject)(b.Nb);else{var d;try{d=c(b.Nb)}catch(e){a.reject(e);return}a.resolve(d)}})}
function y(a){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof a)throw new TypeError("not a function");this.Nb=this.qb=null;this.Mb=[];ua(a,Aa(za,this),Aa(ya,this))}function Aa(a,b){return function(){a.apply(b,arguments)}}var Ba=y.immediateFn||"function"===typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},Ca=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};
y.prototype["catch"]=function(a){return this.then(null,a)};y.prototype.then=function(a,b){var c=this;return new y(function(d,e){xa.call(c,new va(a,b,d,e))})};
y.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&Ca(arguments[0])?arguments[0]:arguments);return new y(function(b,c){function d(f,h){try{if(h&&("object"===typeof h||"function"===typeof h)){var k=h.then;if("function"===typeof k){k.call(h,function(a){d(f,a)},c);return}}a[f]=h;0===--e&&b(a)}catch(m){c(m)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})};y.resolve=function(a){return a&&"object"===typeof a&&a.constructor===y?a:new y(function(b){b(a)})};
y.reject=function(a){return new y(function(b,c){c(a)})};y.race=function(a){return new y(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})};function Da(){var a=HTMLVideoElement.prototype;a.getVideoPlaybackQuality||(a.getVideoPlaybackQuality=function(){return"webkitDroppedFrameCount"in this?{corruptedVideoFrames:0,droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,creationTime:null,totalFrameDelay:null}:null})}n("shaka.polyfill.VideoPlaybackQuality.install",Da);function Ea(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};var Fa=0;function Ga(a,b){this.n=a;this.Hc=b==Ha;this.l=0}var Ha=1;Ga.prototype.Ka=function(){return this.l<this.n.byteLength};function Ia(a){var b=a.n.getUint8(a.l);a.l+=1;return b}function z(a){var b=a.n.getUint32(a.l,a.Hc);a.l+=4;return b}function Ja(a){var b,c;a.Hc?(b=a.n.getUint32(a.l,!0),c=a.n.getUint32(a.l+4,!0)):(c=a.n.getUint32(a.l,!1),b=a.n.getUint32(a.l+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.l+=8;return c*Math.pow(2,32)+b}
function Ka(a){if(a.l+16>a.n.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.n.buffer,a.l,16);a.l+=16;return b}function B(a,b){if(a.l+b>a.n.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.l+=b};function La(a){this.n=a;this.Pa=new Ga(a,0);Ma||(Ma=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Ma;La.prototype.Ka=function(){return this.Pa.Ka()};
function C(a){var b;b=Na(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=Na(a);a:{for(d=0;d<Ma.length;d++)if(Oa(c,Ma[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.Pa.l+c<=a.n.byteLength?c:a.n.byteLength-a.Pa.l;d=new DataView(a.n.buffer,a.n.byteOffset+a.Pa.l,c);B(a.Pa,c);return new Pa(b,d)}function Na(a){var b=Ia(a.Pa),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=Ia(a.Pa);return d}function Pa(a,b){this.id=a;this.n=b}
function Qa(a){if(8<a.n.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.n.byteLength&&a.n.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.n.byteLength;c++)var d=a.n.getUint8(c),b=256*b+d;return b};function Ra(a){this.Wc=Math.exp(Math.log(.5)/a);this.uc=this.Ac=0}Ra.prototype.sample=function(a,b){var c=Math.pow(this.Wc,a);this.Ac=b*(1-c)+c*this.Ac;this.uc+=a};function Sa(a){return a.Ac/(1-Math.pow(a.Wc,a.uc))};function D(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function E(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Ta(a,b,c){Ua(b);Ua(c);return c==b||a>=Va&&c==b.split("-")[0]||a>=Wa&&c.split("-")[0]==b.split("-")[0]?!0:!1}var Va=1,Wa=2;function Ua(a){a=a.toLowerCase().split("-");var b=Xa[a[0]];b&&(a[0]=b);return a.join("-")}
var Xa={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function F(){this.ba={}}l=F.prototype;l.push=function(a,b){this.ba.hasOwnProperty(a)?this.ba[a].push(b):this.ba[a]=[b]};l.set=function(a,b){this.ba[a]=b};l.has=function(a){return this.ba.hasOwnProperty(a)};l.get=function(a){return(a=this.ba[a])?a.slice():null};function Ya(a){var b=[],c;for(c in a.ba)b.push.apply(b,a.ba[c]);return b}l.remove=function(a,b){var c=this.ba[a];if(c)for(var d=0;d<c.length;++d)c[d]==b&&(c.splice(d,1),--d)};l.keys=function(){var a=[],b;for(b in this.ba)a.push(b);return a};
l.clear=function(){this.ba={}};function G(){this.Wa=new F}G.prototype.destroy=function(){Za(this);this.Wa=null};function J(a,b,c,d){b=new $a(b,c,d);a.Wa.push(c,b)}G.prototype.Ib=function(a,b){for(var c=this.Wa.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.Ib(),this.Wa.remove(b,e))}};function Za(a){for(var b=Ya(a.Wa),c=0;c<b.length;++c)b[c].Ib();a.Wa.clear()}function $a(a,b,c){this.target=a;this.type=b;this.kd=c;this.target.addEventListener(b,c,!1)}
$a.prototype.Ib=function(){this.target&&(this.target.removeEventListener(this.type,this.kd,!1),this.kd=this.target=null)};function K(a){this.Gc=new F;this.parent=a}n("shaka.util.FakeEventTarget",K);K.prototype.addEventListener=function(a,b,c){c||this.Gc.push(a,b)};K.prototype.removeEventListener=function(a,b,c){c||this.Gc.remove(a,b)};K.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return ab(this,a)};
function ab(a,b){b.currentTarget=a;for(var c=a.Gc.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){s("Uncaught exception in event handler",f)}}a.parent&&b.bubbles&&ab(a.parent,b);return b.defaultPrevented};function bb(){K.call(this,null);this.Bc=new Ra(3);this.xd=new Ra(10);this.Xd=50;this.Id=5E5;this.Yd=.5;this.Wd=65536;this.hd=0}r(bb,K);n("shaka.util.EWMABandwidthEstimator",bb);bb.prototype.sample=function(a,b){if(!(b<this.Wd)){a=Math.max(a,this.Xd);var c=8E3*b/a,d=a/1E3;this.Bc.sample(d,c);this.xd.sample(d,c);this.dispatchEvent(D({type:"bandwidth"}));this.hd=Date.now()}};bb.prototype.getBandwidth=function(){return this.Bc.uc<this.Yd?this.Id:Math.min(Sa(this.Bc),Sa(this.xd))};
bb.prototype.getDataAge=function(){return(Date.now()-this.hd)/1E3};function L(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;return c};function cb(a){return window.atob(a.replace(/-/g,"+").replace(/_/g,"/"))};function db(){this.Hb=new L;this.Eb=!1;this.fa=null;this.Ea=[];this.Ga=null}db.prototype.append=function(a){if(this.Eb)throw Error("Cannot append to a running task!");this.Ea.push(a)};db.prototype.start=function(){if(this.Eb)throw Error("Task already started!");this.Eb=!0;this.Ea.unshift(function(){});eb(this,void 0)};
db.prototype.abort=function(){if(this.fa)return this.fa;var a=Error("Task aborted.");a.type="aborted";this.Hb.reject(a);if(!this.Eb)return this.Eb=!0,Promise.resolve();this.Ga&&this.Ga();return this.fa=new L};db.prototype.end=function(){this.Ea.splice(1)};
function eb(a,b){var c=a.Ea[0](b),d;c?(d=c[0],a.Ga=c[1]):(d=Promise.resolve(),a.Ga=null);d.then(function(a){this.fa?(this.Ea=[],this.Ga=null,this.fa.resolve(),this.fa=null):(this.Ea.shift(),this.Ea.length?eb(this,a):(this.Hb.resolve(a),this.Ga=null))}.bind(a)).catch(function(a){this.Hb.reject(a);this.Ea=[];this.Ga=null;this.fa&&(this.fa.resolve(),this.fa=null)}.bind(a))};function M(a,b){return b.bind(a)};function fb(a,b){w("PatchedMediaKeys.ms.requestMediaKeySystemAccess");try{var c=new gb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function hb(a){w("PatchedMediaKeys.ms.setMediaKeys");a?(this.wd=a,this.addEventListener("loadedmetadata",ib)):null===a&&(this.wd=null,this.removeEventListener("loadedmetadata",ib));return Promise.resolve()}
function ib(){var a=this.wd;a&&(this.msSetMediaKeys(a.nd),w("ms.MediaKeys.setEvents"),a.ka=this,Za(a.g),J(a.g,this,"msneedkey",a.ie.bind(a)))}function jb(a,b,c){w("ms.MediaKeys");this.Ba=a;this.Hd=b;this.i=c;this.ka=null;this.g=new G;this.nd=window.MSMediaKeys(a);this.M={};this.Sb=null;this.Vb={}}l=jb.prototype;l.ie=function(a){w("ms.MediaKeys.onMsNeedKey");1>this.i.ha.length&&(v("need key fired",this.i.kid),this.i.ha.push(a.initData),this.createSession(a.initData))};
l.createSession=function(a){w("ms.MediaKeys.createSession");a=this.nd.createSession(this.Hd,a);this.M[a.sessionId]=a;a=a.sessionId;w("ms.MediaKeys.setSessionEvents");J(this.g,this.M[a],"mskeymessage",this.he.bind(this));J(this.g,this.M[a],"mskeyadded",this.ee.bind(this));J(this.g,this.M[a],"mskeyerror",this.ge.bind(this));J(this.g,this.M[a],"mskeyclose",this.fe.bind(this))};
l.he=function(a){w("ms.MediaKeys.onMsKeyMessage");var b=a.destinationURL;this.i.Lb&&(b=b+"?token="+encodeURIComponent(this.i.Lb));var c=a.message;w("ms.MediaKeys.parseMsKeyMessage");c=new Uint16Array(c.buffer);c=String.fromCharCode.apply(null,c);c=(new DOMParser).parseFromString(c,"application/xml");if(c.getElementsByTagName("Challenge")[0]){var d=c.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;d&&(this.Sb=cb(d))}else throw Error("Could not find Challenge in mskeymessage event");c=
c.getElementsByTagName("HttpHeader");for(d=0;d<c.length;d++)this.Vb[c[d].getElementsByTagName("name")[0].childNodes[0].nodeValue]=c[d].getElementsByTagName("value")[0].childNodes[0].nodeValue;kb(this,b,a.srcElement.sessionId)};
function kb(a,b,c){w("ms.MediaKeys.doLicenseRequest");var d=new lb(b,a.Sb,a.i.withCredentials,a.Vb),e=a.M[c];v("request license",e,b,a.Sb,a.Vb);d.send().then(M(a,function(a){v("license request success",e);this.i.bc&&(a=this.i.bc(a));e.update(a);return Promise.resolve()})).catch(function(a){throw Error(a);})}l.ee=function(a){w("ms.MediaKeys.onMsKeyAdded");v("ms key added for",this.i.kid,a)};l.ge=function(a){w("ms.MediaKeys.onMsKeyError");s("ms key error",a)};
l.fe=function(a){w("ms.MediaKeys.onMsKeyClose");v("ms key close",a);Za(this.g);this.M={};this.Vb={};this.Sb=null;this.i.ha=[]};
function gb(a,b){w("ms.MediaKeySystemAccess");this.keySystem=a;for(var c=!1,d=0;d<b.length;d++){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes};if(e.audioCapabilities)for(var g=0;g<e.audioCapabilities.length;g++){var h=e.audioCapabilities[g];h.contentType&&(window.MSMediaKeys.isTypeSupported(this.keySystem,h.contentType)?(f.audioCapabilities.push(h),v(this.keySystem+" and "+h.contentType+" is supported."),
c=!0):v(this.keySystem+" and "+h.contentType+" is NOT supported."))}if(e.videoCapabilities)for(g=0;g<e.videoCapabilities.length;g++)h=e.videoCapabilities[g],h.contentType&&(window.MSMediaKeys.isTypeSupported(this.keySystem,h.contentType)?(f.videoCapabilities.push(h),v(this.keySystem+" and "+h.contentType+" is supported."),c=!0):v(this.keySystem+" and "+h.contentType+" is NOT supported."));"required"==e.persistentState&&(f.persistentState="required");if(c){this.Rb=f;return}}throw Error("None of the requested configurations were supported.");
}gb.prototype.getConfiguration=function(){w("ms.MediaKeySystemAccess.getConfiguration");return this.Rb};gb.prototype.createMediaKeys=function(a){a=new jb(this.keySystem,this.Rb.videoCapabilities[0].contentType,a);return Promise.resolve(a)};function nb(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",nb);function ob(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",ob);n("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(nb(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function pb(a){return ob(cb(a))}n("shaka.util.Uint8ArrayUtils.fromBase64",pb);
n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function qb(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",qb);function Oa(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function rb(a,b,c,d,e,f,g,h,k){this.keySystem=a;this.jd=b;this.withCredentials=c;this.ha=[];this.bc=e;this.Lb=f;this.kid=g;this.Jd=h==sb;this.Be=k==tb;d&&this.ha.push(d)}n("shaka.player.DrmSchemeInfo",rb);var sb=1;rb.DistinctiveIdentifier={Dd:0,Ed:sb};var tb=1;rb.PersistentState={Dd:0,Ed:tb};function ub(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}
ub.prototype.clone=function(){var a=new ub;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function vb(){return new rb("","",!1,null,null,"","")}rb.createUnencrypted=vb;function wb(a,b){var c=new rb(a.keySystem,a.jd,a.withCredentials,null,a.bc,a.Lb,a.kid);c.ha=Ea(a.ha.concat(b.ha),function(a){return Array.prototype.join.apply(a.initData)});return c}rb.combine=wb;rb.prototype.key=function(){return JSON.stringify(this)};function xb(a,b){w("v01b.requestMediaKeySystemAccess");try{var c=new yb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function zb(a){w("v01b.setMediaKeys");var b=this.mediaKeys;b&&b!=a&&Ab(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Ab(a,this);return Promise.resolve()}
function yb(a,b){w("v01b.MediaKeySystemAccess");this.ab=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.ab="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes},k=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var p=g.audioCapabilities[m];
p.contentType&&(k=!0,e.canPlayType(p.contentType.split(";")[0],this.ab)&&(h.audioCapabilities.push(p),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)p=g.videoCapabilities[m],p.contentType&&(k=!0,e.canPlayType(p.contentType,this.ab)&&(h.videoCapabilities.push(p),d=!0));k||(d=e.canPlayType("video/mp4",this.ab)||e.canPlayType("video/webm",this.ab));"required"==g.persistentState&&(c?h.persistentState="required":d=!1);if(d){this.Rb=h;return}}throw Error("None of the requested configurations were supported.");
}yb.prototype.createMediaKeys=function(){w("v01b.MediaKeySystemAccess.createMediaKeys");var a=new Bb(this.ab);return Promise.resolve(a)};yb.prototype.getConfiguration=function(){w("v01b.MediaKeySystemAccess.getConfiguration");return this.Rb};function Bb(a){w("v01b.MediaKeys");this.Ba=a;this.ka=null;this.g=new G;this.od=[];this.ud={}}
function Ab(a,b){a.ka=b;Za(a.g);b&&(J(a.g,b,"webkitneedkey",a.Ae.bind(a)),J(a.g,b,"webkitkeymessage",a.ze.bind(a)),J(a.g,b,"webkitkeyadded",a.xe.bind(a)),J(a.g,b,"webkitkeyerror",a.ye.bind(a)))}l=Bb.prototype;
l.createSession=function(a){w("v01b.MediaKeys.createSession");var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.ka||document.createElement("video");a.src||(a.src="about:blank");b=new Cb(a,this.Ba,b);this.od.push(b);return b};l.Ae=function(a){w("v01b.onWebkitNeedKey_",a);a=D({type:"encrypted",initDataType:"webm",initData:a.initData});this.ka.dispatchEvent(a)};
l.ze=function(a){w("v01b.onWebkitKeyMessage_",a);var b=Db(this,a.sessionId);b?(a=D({type:"message",messageType:void 0==b.keyStatuses.wa?"licenserequest":"licenserenewal",message:a.message}),w("v01b.MediaKeySession.generated"),b.Z&&(b.Z.resolve(),b.Z=null),b.dispatchEvent(a)):s("Session not found",a.sessionId)};l.xe=function(a){w("v01b.onWebkitKeyAdded_",a);(a=Db(this,a.sessionId))&&a.ready()};l.ye=function(a){w("v01b.onWebkitKeyError_",a);var b=Db(this,a.sessionId);b&&b.handleError(a)};
function Db(a,b){var c=a.ud[b];return c?(w("v01b.MediaKeys.findSession_",c),c):(c=a.od.shift())?(c.sessionId=b,a.ud[b]=c,w("v01b.MediaKeys.findSession_",c),c):null}function Cb(a,b,c){w("v01b.MediaKeySession");K.call(this,null);this.ka=a;this.gd=!1;this.S=this.Z=null;this.Ba=b;this.ra=c;this.sessionId="";this.expiration=NaN;this.closed=new L;this.keyStatuses=new Eb}r(Cb,K);l=Cb.prototype;l.ready=function(){w("v01b.MediaKeySession.ready");Fb(this,"usable");this.S&&this.S.resolve();this.S=null};
l.handleError=function(a){w("v01b.MediaKeySession.handleError",a);var b=Error("EME v0.1b key error");b.errorCode=a.errorCode;b.errorCode.systemCode=a.systemCode;!a.sessionId&&this.Z?(b.method="generateRequest",45==a.systemCode&&(b.message="Unsupported session type."),this.Z.reject(b),this.Z=null):a.sessionId&&this.S?(b.method="update",this.S.reject(b),this.S=null):(b=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Fb(this,"output-not-allowed"):1==b?Fb(this,"expired"):Fb(this,"internal-error"))};
function Gb(a,b,c){if(a.gd)return Promise.reject(Error("The session is already initialized."));a.gd=!0;try{var d;if("persistent-license"==a.ra)if(c)d=ob("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=ob("PERSISTENT|"+nb(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.Z=new L;try{a.ka.webkitGenerateKeyRequest(a.Ba,d)}catch(g){if("InvalidStateError"!=g.name)return a.Z=null,Promise.reject(g);setTimeout(function(){try{this.ka.webkitGenerateKeyRequest(this.Ba,d)}catch(a){this.Z.reject(a),
this.Z=null}}.bind(a),10)}return a.Z}
l.Uc=function(a,b){if(this.S)this.S.then(this.Uc.bind(this,a,b)).catch(this.Uc.bind(this,a,b));else{this.S=a;var c,d;if("webkit-org.w3.clearkey"==this.Ba){c=nb(new Uint8Array(b));d=JSON.parse(c);c=d.keys[0].kty;if("A128KW"!=d.keys[0].alg||"oct"!=c)this.S.reject(Error("Response is not a valid JSON Web Key Set.")),this.S=null;c=pb(d.keys[0].k);d=pb(d.keys[0].kid)}else c=new Uint8Array(b),d=null;try{this.ka.webkitAddKey(this.Ba,c,d,this.sessionId)}catch(e){this.S.reject(e),this.S=null}}};
function Fb(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.wa=b;c=D({type:"keystatuseschange"});a.dispatchEvent(c)}l.generateRequest=function(a,b){w("v01b.MediaKeySession.generateRequest");return Gb(this,b,null)};l.load=function(a){w("v01b.MediaKeySession.load");return"persistent-license"==this.ra?Gb(this,null,a):Promise.reject(Error("Not a persistent session."))};l.update=function(a){w("v01b.MediaKeySession.update",a);var b=new L;this.Uc(b,a);return b};
l.close=function(){w("v01b.MediaKeySession.close");if("persistent-license"!=this.ra){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.ka.webkitCancelKeyRequest(this.Ba,this.sessionId)}this.closed.resolve();return this.closed};l.remove=function(){w("v01b.MediaKeySession.remove");return"persistent-license"!=this.ra?Promise.reject(Error("Not a persistent session.")):this.close()};function Hb(a){this.Cd=a;this.fd=0}
Hb.prototype.next=function(){return this.fd>=this.Cd.length?{value:void 0,done:!0}:{value:this.Cd[this.fd++],done:!1}};function Eb(){this.size=0;this.wa=void 0}var Ib;l=Eb.prototype;l.forEach=function(a){this.wa&&a(this.wa)};l.get=function(a){if(this.has(a))return this.wa};l.has=function(a){var b=Ib;return this.wa&&Oa(new Uint8Array(a),b)?!0:!1};l.keys=function(){var a=Ib,b=[];this.wa&&b.push(a);return new Hb(b)};l.values=function(){var a=[];this.wa&&a.push(this.wa);return new Hb(a)};function Jb(){w("MediaKeys.install");Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?v("Using native EME as-is."):window.MSMediaKeys?(v("Using ms prefixed EME"),w("PatchedMediaKeys.ms.install"),Navigator.prototype.requestMediaKeySystemAccess=fb,HTMLMediaElement.prototype.setMediaKeys=hb):HTMLMediaElement.prototype.webkitGenerateKeyRequest?(v("Using prefixed EME v0.1b."),w("v01b.install"),Ib=ob("FAKE_KEY_ID"),Navigator.prototype.requestMediaKeySystemAccess=
xb,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=zb,window.MediaKeys=Bb,window.MediaKeySystemAccess=yb):(v("EME not available."),w("PatchedMediaKeys.nop.install"),Navigator.prototype.requestMediaKeySystemAccess=qa,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ra,window.MediaKeys=sa,window.MediaKeySystemAccess=ta)}
n("shaka.polyfill.MediaKeys.install",Jb);n("shaka.polyfill.installAll",function(){window.Promise||(v("Installing Promise"),window.Promise=y);ma();oa();Jb();Da()});function Kb(a){this.systemIds=[];this.cencKeyIds=[];a=new Ga(new DataView(a.buffer),0);try{for(;a.Ka();){var b=a.l,c=z(a),d=z(a);1==c?c=Ja(a):0==c&&(c=a.n.byteLength-b);if(1886614376!=d)t("Non-PSSH box found!"),B(a,c-(a.l-b));else{var e=Ia(a);if(1<e)t("Unrecognized PSSH version found!"),B(a,c-(a.l-b));else{B(a,3);var f=qb(Ka(a)),g=[];if(0<e)for(var h=z(a),k=0;k<h;++k){var m=qb(Ka(a));g.push(m)}var p=z(a);B(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.l!=b+c&&(t("Mismatch between box size and data size!"),
B(a,c-(a.l-b)))}}}}catch(q){t("PSSH parse failure!  Some data may be missing or incorrect.")}};var Lb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function N(a){var b;a instanceof N?(Mb(this,a.Da),this.Ta=a.Ta,this.ta=a.ta,Nb(this,a.hb),this.ma=a.ma,Ob(this,a.jb.clone()),this.Ja=a.Ja):a&&(b=String(a).match(Lb))?(Mb(this,b[1]||"",!0),this.Ta=Pb(b[2]||""),this.ta=Pb(b[3]||"",!0),Nb(this,b[4]),this.ma=Pb(b[5]||"",!0),Ob(this,b[6]||"",!0),this.Ja=Pb(b[7]||"")):this.jb=new Qb(null)}l=N.prototype;l.Da="";l.Ta="";l.ta="";l.hb=null;l.ma="";l.Ja="";
l.toString=function(){var a=[],b=this.Da;b&&a.push(Rb(b,Sb,!0),":");if(b=this.ta){a.push("//");var c=this.Ta;c&&a.push(Rb(c,Sb,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.hb;null!=b&&a.push(":",String(b))}if(b=this.ma)this.ta&&"/"!=b.charAt(0)&&a.push("/"),a.push(Rb(b,"/"==b.charAt(0)?Tb:Ub,!0));(b=this.jb.toString())&&a.push("?",b);(b=this.Ja)&&a.push("#",Rb(b,Vb));return a.join("")};
l.resolve=function(a){var b=this.clone(),c=!!a.Da;c?Mb(b,a.Da):c=!!a.Ta;c?b.Ta=a.Ta:c=!!a.ta;c?b.ta=a.ta:c=null!=a.hb;var d=a.ma;if(c)Nb(b,a.hb);else if(c=!!a.ma){if("/"!=d.charAt(0))if(this.ta&&!this.ma)d="/"+d;else{var e=b.ma.lastIndexOf("/");-1!=e&&(d=b.ma.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||1==f.length&&
""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.ma=d:c=""!==a.jb.toString();c?Ob(b,a.jb.clone()):c=!!a.Ja;c&&(b.Ja=a.Ja);return b};l.clone=function(){return new N(this)};function Mb(a,b,c){a.Da=c?Pb(b,!0):b;a.Da&&(a.Da=a.Da.replace(/:$/,""))}function Nb(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.hb=b}else a.hb=null}function Ob(a,b,c){b instanceof Qb?a.jb=b:(c||(b=Rb(b,Wb)),a.jb=new Qb(b))}
function Pb(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Rb(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Xb),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Xb(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Sb=/[#\/\?@]/g,Ub=/[\#\?:]/g,Tb=/[\#\?]/g,Wb=/[\#\?@]/g,Vb=/#/g;function Qb(a){this.ub=a||null}Qb.prototype.Na=null;Qb.prototype.Zc=null;
Qb.prototype.toString=function(){if(this.ub)return this.ub;if(!this.Na)return"";var a=[],b;for(b in this.Na)for(var c=encodeURIComponent(b),d=this.Na[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.ub=a.join("&")};Qb.prototype.clone=function(){var a=new Qb;a.ub=this.ub;if(this.Na){var b={},c;for(c in this.Na)b[c]=this.Na[c].concat();a.Na=b;a.Zc=this.Zc}return a};function Yb(){this.id=null;this.type="static";this.ia=this.d=null;this.U=5;this.ob=this.Pb=this.zb=null;this.Sc=1;this.B=[]}function Zb(){this.C=this.L=this.P=this.d=this.duration=this.start=this.id=null;this.xa=[]}function $b(){this.C=this.L=this.P=this.d=this.X=this.m=this.height=this.width=this.contentType=this.lang=this.id=null;this.F=[];this.O=[]}function ac(){this.value=null}function bc(){this.contentType=this.lang=this.id=null}
function cc(){this.C=this.L=this.P=this.d=this.X=this.m=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.F=[];this.wb=!1}function dc(){this.value=this.schemeIdUri=null;this.children=[];this.KID=this.pssh=null}function ec(){this.parsedPssh=this.psshBox=null}function fc(){this.url=null}function gc(){this.d=null;this.o=1;this.$=this.Qa=this.Aa=this.t=null}
gc.prototype.clone=function(){var a=new gc;a.d=this.d?new N(this.d):null;a.o=this.o;a.t=this.t;a.Aa=O(this.Aa);a.Qa=O(this.Qa);a.$=O(this.$);return a};function hc(){this.V=this.url=null}hc.prototype.clone=function(){var a=new hc;a.url=this.url?new N(this.url):null;a.V=O(this.V);return a};function ic(){this.V=this.url=null}ic.prototype.clone=function(){var a=new ic;a.url=this.url?new N(this.url):null;a.V=O(this.V);return a};
function jc(){this.d=null;this.o=1;this.u=this.t=null;this.W=1;this.$=null;this.Ra=[]}jc.prototype.clone=function(){var a=new jc;a.d=this.d?new N(this.d):null;a.o=this.o;a.t=this.t;a.u=this.u;a.W=this.W;a.$=O(this.$);a.Ra=this.Ra.map(function(a){return a.clone()});return a};function kc(){this.cb=this.N=null}kc.prototype.clone=function(){var a=new kc;a.N=this.N?new N(this.N):null;a.cb=O(this.cb);return a};function lc(){this.o=1;this.u=this.t=null;this.W=1;this.Sa=this.ua=this.La=this.ja=null}
lc.prototype.clone=function(){var a=new lc;a.o=this.o;a.t=this.t;a.u=this.u;a.W=this.W;a.ja=this.ja;a.La=this.La;a.ua=this.ua;a.Sa=O(this.Sa);return a};function mc(){this.sc=[]}mc.prototype.clone=function(){var a=new mc;a.sc=this.sc.map(function(a){return a.clone()});return a};function nc(){this.repeat=this.duration=this.startTime=null}nc.prototype.clone=function(){var a=new nc;a.startTime=this.startTime;a.duration=this.duration;a.repeat=this.repeat;return a};
function oc(a,b){this.Va=a;this.end=b}oc.prototype.clone=function(){return new oc(this.Va,this.end)};Yb.TAG_NAME="MPD";Zb.TAG_NAME="Period";$b.TAG_NAME="AdaptationSet";ac.TAG_NAME="Role";bc.TAG_NAME="ContentComponent";cc.TAG_NAME="Representation";dc.TAG_NAME="ContentProtection";ec.TAG_NAME="cenc:pssh";fc.TAG_NAME="BaseURL";gc.TAG_NAME="SegmentBase";hc.TAG_NAME="RepresentationIndex";ic.TAG_NAME="Initialization";jc.TAG_NAME="SegmentList";kc.TAG_NAME="SegmentURL";lc.TAG_NAME="SegmentTemplate";
mc.TAG_NAME="SegmentTimeline";nc.TAG_NAME="S";Yb.prototype.parse=function(a,b){this.id=P(b,"id",Q);this.type=P(b,"type",Q)||"static";this.ia=P(b,"mediaPresentationDuration",pc);this.U=P(b,"minBufferTime",pc,this.U);this.zb=P(b,"minimumUpdatePeriod",pc,this.zb);this.Pb=P(b,"availabilityStartTime",qc,this.Pb);this.ob=P(b,"timeShiftBufferDepth",pc,this.ob);this.Sc=P(b,"suggestedPresentationDelay",pc,this.Sc);var c=R(this,b,fc);this.d=rc(a.d,c?c.url:null);this.B=sc(this,b,Zb)};
Zb.prototype.parse=function(a,b){this.id=P(b,"id",Q);this.start=P(b,"start",pc);this.duration=P(b,"duration",pc);var c=R(this,b,fc);this.d=rc(a.d,c?c.url:null);this.P=R(this,b,gc);this.L=R(this,b,jc);this.C=R(this,b,lc);this.xa=sc(this,b,$b)};
$b.prototype.parse=function(a,b){var c=R(this,b,bc)||{},d=R(this,b,ac);this.id=P(b,"id",Q);this.lang=P(b,"lang",Q,c.lang);this.contentType=P(b,"contentType",Q,c.contentType);this.width=P(b,"width",S);this.height=P(b,"height",S);this.m=P(b,"mimeType",Q);this.X=P(b,"codecs",Q);this.wb=d&&"main"==d.value;this.lang&&(this.lang=Ua(this.lang));c=R(this,b,fc);this.d=rc(a.d,c?c.url:null);this.F=sc(this,b,dc);c=null;for(d=0;d<this.F.length;d++)if(null!=this.F[d].KID){c=this.F[d].KID;break}for(d=0;d<this.F.length;d++)null==
this.F[d].KID&&(this.F[d].KID=c);!this.contentType&&this.m&&(this.contentType=this.m.split("/")[0]);this.P=a.P?tc(this,b,a.P):R(this,b,gc);this.L=a.L?tc(this,b,a.L):R(this,b,jc);this.C=a.C?tc(this,b,a.C):R(this,b,lc);this.O=sc(this,b,cc);!this.m&&this.O.length&&(this.m=this.O[0].m,!this.contentType&&this.m&&(this.contentType=this.m.split("/")[0]))};ac.prototype.parse=function(a,b){this.value=P(b,"value",Q)};
bc.prototype.parse=function(a,b){this.id=P(b,"id",Q);this.lang=P(b,"lang",Q);this.contentType=P(b,"contentType",Q);this.lang&&(this.lang=Ua(this.lang))};
cc.prototype.parse=function(a,b){this.id=P(b,"id",Q);this.bandwidth=P(b,"bandwidth",S);this.width=P(b,"width",S,a.width);this.height=P(b,"height",S,a.height);this.m=P(b,"mimeType",Q,a.m);this.X=P(b,"codecs",Q,a.X);this.lang=a.lang;var c=R(this,b,fc);this.d=rc(a.d,c?c.url:null);this.F=sc(this,b,dc);this.P=a.P?tc(this,b,a.P):R(this,b,gc);this.L=a.L?tc(this,b,a.L):R(this,b,jc);this.C=a.C?tc(this,b,a.C):R(this,b,lc);0==this.F.length&&(this.F=a.F)};
dc.prototype.parse=function(a,b){this.schemeIdUri=P(b,"schemeIdUri",Q);this.value=P(b,"value",Q);this.KID=P(b,"cenc:default_KID",Q);this.pssh=R(this,b,ec);this.children=Array.prototype.slice.call(b.childNodes)};ec.prototype.parse=function(a,b){var c=uc(b);if(c){this.psshBox=pb(c);try{this.parsedPssh=new Kb(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};fc.prototype.parse=function(a,b){this.url=uc(b)};
gc.prototype.parse=function(a,b){this.d=a.d||this.d;this.o=P(b,"timescale",S,this.o);this.t=P(b,"presentationTimeOffset",T,this.t);this.Aa=P(b,"indexRange",vc,this.Aa);this.Qa=R(this,b,hc)||this.Qa;this.$=R(this,b,ic)||this.$};hc.prototype.parse=function(a,b){var c=P(b,"sourceURL",Q);this.url=rc(a.d,c);this.V=P(b,"range",vc,O(a.Aa))};ic.prototype.parse=function(a,b){var c=P(b,"sourceURL",Q);this.url=rc(a.d,c);this.V=P(b,"range",vc)};
jc.prototype.parse=function(a,b){this.d=a.d||this.d;this.o=P(b,"timescale",S,this.o);this.t=P(b,"presentationTimeOffset",T,this.t);this.u=P(b,"duration",S,this.u);this.W=P(b,"startNumber",S,this.W)||1;this.$=R(this,b,ic)||this.$;this.Ra=sc(this,b,kc)||this.Ra};kc.prototype.parse=function(a,b){var c=P(b,"media",Q);this.N=rc(a.d,c);this.cb=P(b,"mediaRange",vc)};
lc.prototype.parse=function(a,b){this.o=P(b,"timescale",S,this.o);this.t=P(b,"presentationTimeOffset",T,this.t);this.u=P(b,"duration",S,this.u);this.W=P(b,"startNumber",S,this.W)||1;this.ja=P(b,"media",Q,this.ja);this.La=P(b,"index",Q,this.La);this.ua=P(b,"initialization",Q,this.ua);this.Sa=R(this,b,mc)||this.Sa};mc.prototype.parse=function(a,b){this.sc=sc(this,b,nc)};nc.prototype.parse=function(a,b){this.startTime=P(b,"t",T);this.duration=P(b,"d",T);this.repeat=P(b,"r",T)};
function rc(a,b){var c=b?new N(b):null;return a?c?a.resolve(c):a:c}function tc(a,b,c){var d=O(c);(b=wc(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function R(a,b,c){var d=null;if(b=wc(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}function wc(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}
function sc(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function uc(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function O(a){return a?a.clone():null}function P(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function qc(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function pc(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return t("Invalid duration string:",a),null;a=0;var c=T(b[1]);c&&(a+=31536E3*c);(c=T(b[2]))&&(a+=2592E3*c);(c=T(b[3]))&&(a+=86400*c);(c=T(b[4]))&&(a+=3600*c);(c=T(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function vc(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=T(b[1]);if(null==a)return null;b=T(b[2]);return null==b?null:new oc(a,b)}function S(a){a=window.parseInt(a,10);return 0<a?a:null}function T(a){a=window.parseInt(a,10);return 0<=a?a:null}function Q(a){return a};function xc(a,b,c,d,e,f){this.id=a;this.startTime=b;this.endTime=c;this.Fa=d;this.Za=e;this.url=f}function yc(a,b,c){return new xc(a.id,b,c,a.Fa,a.Za,a.url)};function zc(a){this.eb=a}zc.prototype.parse=function(a,b,c){a=null;try{a=this.Nc(b,c)}catch(d){if(!(d instanceof RangeError))throw d;}return a};
zc.prototype.Nc=function(a,b){var c=new Ga(a,0),d=[],e=z(c);if(1936286840!=z(c))return s('Invalid box type, expected "sidx".'),null;1==e&&(e=Ja(c));var f=Ia(c);B(c,3);B(c,4);var g=z(c);if(0==g)return s("Invalid timescale."),null;var h,k;0==f?(h=z(c),k=z(c)):(h=Ja(c),k=Ja(c));B(c,2);f=c.n.getUint16(c.l,c.Hc);c.l+=2;e=b+e+k;for(k=0;k<f;k++){var m=z(c),p=(m&2147483648)>>>31,m=m&2147483647,q=z(c);z(c);if(1==p)return s("Heirarchical SIDXs are not supported."),null;d.push(new xc(k,h/g,(h+q)/g,e,e+m-1,this.eb));
h+=q;e+=m}return d};function Ac(a){this.kb=a};function U(a){this.h=a;this.pb=0;Bc(this)}U.prototype.length=function(){return this.h.length};U.prototype.first=function(){if(0==this.h.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return this.h[0]};function V(a){if(0==a.h.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.h[a.h.length-1]}U.prototype.get=function(a){if(0>a||a>=this.h.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.h[a]};
function Cc(a,b,c){var d=a.find(b);if(0>d)return null;for(var e=[];d<a.h.length;d++){e.push(a.h[d]);var f=a.h[d].endTime;if(!f||f>b+c)break}return new Ac(e)}U.prototype.find=function(a){for(var b=0;b<this.h.length;b++)if(this.h[b].startTime>a)return b?b-1:0;return this.h.length-1};function Dc(a,b){return a.map(function(a){return yc(a,a.startTime+b,null!=a.endTime?a.endTime+b:null)})}
function Bc(a){var b,c=a.h;ba(c.every(function(a,e){var f=!0;0!=e&&(f=a.startTime>=b.startTime&&a.startTime<=b.endTime&&(a.endTime&&a.endTime>=b.endTime||e==c.length-1));b=a;return f}));ba(Ea(c,function(a){return a.id}).length==c.length)};function Ec(a){this.eb=a}Ec.prototype.parse=function(a,b){var c=null;try{c=this.Nc(a,b)}catch(d){if(!(d instanceof RangeError))throw d;}return c};
Ec.prototype.Nc=function(a,b){var c;var d=new La(a);if(440786851!=C(d).id)s("EBML element does not exist."),c=null;else if(c=C(d),408125543!=c.id)s("Segment element does not exist."),c=null;else{d=c.n.byteOffset;c=new La(c.n);for(var e=null;c.Ka();){var f=C(c);if(357149030==f.id){e=f;break}}if(e){c=new La(e.n);for(e=1E6;c.Ka();)if(f=C(c),2807729==f.id){e=Qa(f);break}c=e/1E9}else s("Info element does not exist."),c=null;c=c?{Ge:d,Qe:c}:null}if(!c)return null;e=C(new La(b));if(475249515!=e.id)return s("CuesElement does not exist."),
null;d=c.Ge;c=c.Qe;for(var e=new La(e.n),f=[],g=-1,h=-1,k=0;e.Ka();){var m=C(e);if(187==m.id){var p;p=new La(m.n);m=C(p);if(179!=m.id)t("CueTime element does not exist."),p=null;else if(m=Qa(m),p=C(p),183!=p.id)t("CueTrackPositions element does not exist."),p=null;else{p=new La(p.n);for(var q=0;p.Ka();){var u=C(p);if(241==u.id){q=Qa(u);break}}p={Se:m,Ce:q}}p&&(m=c*p.Se,p=d+p.Ce,0<=g&&(f.push(new xc(k,g,m,h,p-1,this.eb)),++k),g=m,h=p)}}0<=g&&f.push(new xc(k,g,null,h,null,this.eb));return f};function Fc(a){this.url=a;this.j=new Gc;this.Cb=this.yd=this.yc=0;this.p=null;this.na=new L;this.T=null}function Gc(){this.body=null;this.xb=1;this.Yc=1E3;this.Ee=2;this.Fe=.5;this.fc=0;this.method="GET";this.responseType="arraybuffer";this.ec={};this.zd=this.withCredentials=!1}function Hc(a){Ic(a);a.j.body=null;a.na=null;a.T=null}function Ic(a){a.p&&(a.p.onload=null,a.p.onreadystatechange=null,a.p.onerror=null,a.p.ontimeout=null);a.p=null}l=Fc.prototype;
l.mc=function(){if(this.p||!0==this.url)return this.na;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?cb(b):window.decodeURIComponent(b);"arraybuffer"==this.j.responseType&&(b=ob(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.na;b.resolve(a);Hc(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Jc(this);this.yc++;this.yd=Date.now();this.Cb||(this.Cb=this.j.Yc);
this.p=new XMLHttpRequest;this.p.open(this.j.method,this.url,!0);this.p.responseType=this.j.responseType;this.p.timeout=this.j.fc;this.p.withCredentials=this.j.withCredentials;this.p.onload=this.ce.bind(this);this.j.zd&&(this.p.onreadystatechange=this.me.bind(this));this.p.onerror=this.Kc.bind(this);this.p.ontimeout=this.ve.bind(this);for(b in this.j.ec)this.p.setRequestHeader(b,this.j.ec[b]);this.p.send(this.j.body);return this.na};
function Jc(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new Kc(null,null);return Lc(e).then(function(){return Mc(e,c,d)}).then(M(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.na;a.resolve(b);W(e);Hc(this);return a})).catch(M(a,function(a){W(e);Hc(this);return Promise.reject(a)}))}function Nc(a,b,c){b=Error(b);b.type=c;b.status=a.p.status;b.url=a.url;b.method=a.j.method;b.body=a.j.body;b.Te=a.p;return b}
l.abort=function(){if(this.p&&this.p.readyState!=XMLHttpRequest.DONE){this.p.abort();var a=Nc(this,"Request aborted.","aborted");this.na.reject(a);Hc(this)}};l.ce=function(a){this.T&&this.T.sample(Date.now()-this.yd,a.loaded);200<=this.p.status&&299>=this.p.status?(this.na.resolve(this.p),Hc(this)):this.yc<this.j.xb?Oc(this):(a=Nc(this,"HTTP error.","net"),this.na.reject(a),Hc(this))};
l.me=function(){if(this.p.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.p.getResponseHeader("Date"));a&&(Fa=a-Date.now())}};l.Kc=function(){var a=Nc(this,"Network failure.","net");this.na.reject(a);Hc(this)};l.ve=function(){if(this.yc<this.j.xb)Oc(this);else{var a=Nc(this,"Request timmedout.","net");this.na.reject(a);Hc(this)}};function Oc(a){Ic(a);window.setTimeout(a.mc.bind(a),a.Cb*(1+(2*Math.random()-1)*a.j.Fe));a.Cb*=a.j.Ee};function Pc(a){Fc.call(this,a);this.j.responseType="text";this.j.xb=3;this.j.fc=Qc;this.j.zd=!0}r(Pc,Fc);var Qc=0;Pc.prototype.send=function(){var a=this.url;return this.mc().then(function(b){b=b.responseText;if(b=(new DOMParser).parseFromString(b,"text/xml")){var c={d:new N(a)};b=R(c,b,Yb)}else s("Failed to parse MPD XML."),b=null;if(b)return Promise.resolve(b);b=Error("MPD parse failure.");b.type="mpd";return Promise.reject(b)})};function lb(a,b,c,d){Fc.call(this,a);this.j.body=b;this.j.ec=d;this.j.method="POST";this.j.xb=3;this.j.withCredentials=c;this.j.fc=Rc}r(lb,Fc);var Rc=0;lb.prototype.send=function(){return this.mc().then(function(a){return Promise.resolve(new Uint8Array(a.response))})};function Sc(a,b,c,d,e){Fc.call(this,a);if(b||c)this.j.ec.Range="bytes="+(b+"-"+(null!=c?c:""));d&&(this.j.xb=d);e&&(this.j.Yc=e);this.j.fc=Tc}r(Sc,Fc);var Tc=0;Sc.prototype.send=function(){return this.mc().then(M(this,function(a){return Promise.resolve(a.response)}))};function Uc(a,b,c){this.ld=a;this.pa=b;this.J=c;this.g=new G;this.Ma={};this.Oa=this.D=null;J(this.g,this.pa,"updateend",this.se.bind(this))}var Vc=1/60;Uc.prototype.destroy=function(){this.abort();this.Ma=this.D=this.Oa=null;this.g.destroy();this.ld=this.pa=this.g=null};function Wc(a,b){for(var c=a.pa.buffered,d=0;d<c.length;++d){var e=c.start(d)-Vc,f=c.end(d)+Vc;if(b>=e&&b<=f)return c.end(d)-b}return 0}l=Uc.prototype;
l.$a=function(a,b,c){x("fetch");if(this.D)return c=Error("Cannot fetch: previous operation not complete."),c.type="stream",Promise.reject(c);this.D=new db;b&&this.D.append(function(){return[Xc(this,b),this.wc.bind(this)]}.bind(this));var d=!0;a=a.kb;if(a.length){for(var e=a[0].url.toString(),f=1;f<a.length;++f)if(a[f].url.toString()!=e){d=!1;break}if(d)Yc(this,a,c);else for(f=0;f<a.length;++f)Yc(this,[a[f]],c)}return this.I()};
l.clear=function(){x("clear");if(this.D){var a=Error("Cannot clear: previous operation not complete.");a.type="stream";return Promise.reject(a)}this.D=new db;this.D.append(function(){var a;a:if(0==this.pa.buffered.length)x("Nothing to clear."),Object.keys(this.Ma),a=Promise.resolve();else{try{this.pa.remove(0,Number.POSITIVE_INFINITY)}catch(c){w("Failed to clear buffer:",c);a=Promise.reject(c);break a}this.Ma={};a=this.Oa=new L}return[a,this.wc.bind(this)]}.bind(this));return this.I()};
l.reset=function(){this.Ma={}};l.abort=function(){x("abort");return this.D?this.D.abort():Promise.resolve()};
function Yc(a,b,c){x("appendFetchStages_");ba(b.every(function(a){return a.url==b[0].url}));a.D.append(function(){var a=new Sc(b[0].url.toString(),b[0].Fa,b[b.length-1].Za,3,1E3*(b[0].endTime?b[0].endTime-b[0].startTime:1));a.T=this.J;return[a.send().catch(function(a){if(-1!=c.indexOf(a.status))this.D.end();else return Promise.reject(a)}.bind(this)),a.abort.bind(a)]}.bind(a));a.D.append(function(a){w("Estimated bandwidth:",(this.J.getBandwidth()/1E6).toFixed(2),"Mbps");return[Xc(this,a),this.wc.bind(this)]}.bind(a));
a.D.append(function(){for(var a=0;a<b.length;++a)this.Ma[b[a].id]=!0}.bind(a))}l.I=function(){this.D.start();return this.D.Hb.then(function(){this.D=null}.bind(this)).catch(function(a){this.D=null;return Promise.reject(a)}.bind(this))};function Xc(a,b){try{a.pa.appendBuffer(b)}catch(c){return w("Failed to append buffer:",c),Promise.reject(c)}a.Oa=new L;return a.Oa}l.wc=function(){"open"==this.ld.readyState&&this.pa.abort()};l.se=function(){x("onSourceBufferUpdateEnd_");this.Oa.resolve();this.Oa=null};function Zc(){this.R=$c++;this.id=null;this.timestampOffset=0;this.height=this.width=this.bandwidth=this.sa=null;this.X=this.m="";this.N=null;this.enabled=!0;this.Pc=this.da=this.f=this.oa=this.mb=null}var $c=0;function ad(a){return a.oa?a.ad():Promise.resolve()}
function ed(a){if(!a.mb||a.f)return Promise.resolve();if(!a.N)return a=Error("Cannot create segment index without a media URL."),a.type="stream",Promise.reject(a);var b=0<=a.m.indexOf("mp4"),c=0<=a.m.indexOf("webm");if(!b&&!c)return a=Error("Cannot create segment index with an unsupported MIME type."),a.type="stream",Promise.reject(a);if(c&&!a.da&&!a.oa)return a=Error("Cannot create segment index for WebM content without an initialization segment."),a.type="stream",Promise.reject(a);var d=fd(a);c&&
(d=d.then(a.ad.bind(a)));return d=d.then(M(a,function(){var a=null,a=b?new zc(this.N):new Ec(this.N),c=this.da?new DataView(this.da):null,d=new DataView(this.Pc),a=a.parse(c,d,this.mb.Fa);if(!a)return a=Error("Cannot parse segment references."),a.type="stream",Promise.reject(a);this.f=new U(a);return Promise.resolve()}))}function fd(a){return a.Pc?Promise.resolve():a.mb.$a().then(M(a,function(a){this.Pc=a;return Promise.resolve()}))}
Zc.prototype.ad=function(){return this.da?Promise.resolve():this.oa.$a().then(M(this,function(a){this.da=a;return Promise.resolve()}))};function gd(a){var b=a.m||"";a.X&&(b+='; codecs="'+a.X+'"');return b}function hd(){this.url=null;this.Fa=0;this.Za=null}hd.prototype.$a=function(){return(new Sc(this.url.toString(),this.Fa,this.Za)).send()};function id(){this.R=jd++;this.id=null;this.contentType="";this.e=[];this.Ya=[];this.lang="";this.wb=!1}var jd=0;
id.prototype.Dc=function(){for(var a=[],b=0;b<this.Ya.length;++b){var c=new kd;c.id=this.R;c.Y=this.Ya[b];c.contentType=this.contentType;c.za=this.e.length?gd(this.e[0]):"";a.push(c)}return a};function ld(){this.id=null;this.start=0;this.duration=null;this.A=[]}ld.prototype.Dc=function(){for(var a=[],b=0;b<this.A.length;++b)a.push.apply(a,this.A[b].Dc());return a};function md(){this.aa=!1;this.U=0;this.q=[]}function kd(){this.id=0;this.Y=null;this.za=this.contentType=""};function nd(a){this.bb=a;this.b=new md}
nd.prototype.ib=function(a){this.b=new md;for(var b=0;b<a.B.length;++b)for(var c=a.B[b],d=0;d<c.xa.length;++d){var e=c.xa[d];if("text"!=e.contentType)for(var f=0;f<e.O.length;++f){var g=e.O[f],h=0,h=h+(g.P?1:0),h=h+(g.L?1:0),h=h+(g.C?1:0);0==h?(t("Representation does not contain any segment information. A Representation must contain one of SegmentBase, SegmentList, or SegmentTemplate.",g),e.O.splice(f,1),--f):1!=h&&(t("Representation contains multiple segment information sources. A Representation should only contain one of SegmentBase, SegmenstList, or SegmentTemplate.",g),
g.P?(v("Using SegmentBase by default."),g.L=null,g.C=null):g.L&&(v("Using SegmentList by default."),g.C=null))}}od(a);for(b=0;b<a.B.length;++b)for(c=a.B[b],d=0;d<c.xa.length;++d){f=e=c.xa[d];g=null;for(h=0;h<f.O.length;++h){var k=f.O[h].m||"";g?k!=g&&(t("Representation has an inconsistent mime type.",f.O[h]),f.O.splice(h,1),--h):g=k}0==e.O.length&&(c.xa.splice(d,1),--d)}this.b.aa="dynamic"==a.type;this.b.U=a.U||5;for(b=0;b<a.B.length;++b){c=a.B[b];d=new ld;d.id=c.id;d.start=c.start||0;d.duration=
c.duration;for(e=0;e<c.xa.length;++e){f=c.xa[e];g=new id;g.id=f.id;g.wb=f.wb;g.contentType=f.contentType||"";g.lang=f.lang||"";for(k=h=0;k<f.O.length;++k){var m=f.O[k],p=g.Ya.slice(0),q=m,u=p,H=[];if(0==q.F.length)H.push(vb());else if(this.bb)for(var A=0;A<q.F.length;++A){var I=this.bb(q.F[A]);I&&H.push(I)}if(0==u.length)Array.prototype.push.apply(u,H);else for(q=0;q<u.length;++q){A=!1;for(I=0;I<H.length;++I)if(u[q].key()==H[I].key()){A=!0;break}A||(u.splice(q,1),--q)}if(0==p.length&&0<g.Ya.length)t("Representation does not contain any DRM schemes that are in common with other Representations within its AdaptationSet.",
m);else{u=a;H=c;q=m;m=new Zc;m.id=q.id;m.bandwidth=q.bandwidth;m.width=q.width;m.height=q.height;m.m=q.m||"";m.X=q.X||"";A=void 0;if(q.P)u=q.P,(u.Aa||u.Qa&&u.Qa.V)&&u.d?(u.t&&(m.timestampOffset=-1*u.t/u.o),H=u.Qa,H||(H=new hc,H.url=new N(u.d),H.V=u.Aa?u.Aa.clone():null),m.N=new N(u.d),m.mb=pd(H),m.oa=pd(u.$),A=!0):(t("A SegmentBase must have a segment index URL and a base URL.",u),A=!1);else if(q.L)if(u=q.L,!u.u&&1<u.Ra.length)t("A SegmentList without a segment duration can only have one segment.",
u),A=!1;else{m.oa=pd(u.$);for(var mb=0,H=[],q=0;q<u.Ra.length;++q){var A=u.Ra[q],I=0==q?0:mb,bd=mb=null,je=I/u.o;u.u&&(mb=I+u.u,bd=mb/u.o);var cd=0,dd=null;A.cb&&(cd=A.cb.Va,dd=A.cb.end);H.push(new xc(I,je,bd,cd,dd,new N(A.N)))}m.f=new U(H);w("Generated SegmentIndex from SegmentList",m.f);A=!0}else q.C?(A=q.C,I=void 0,A.La?(A.Sa&&t("Ignoring SegmentTimeline because an explicit segment index URL was provided for the SegmentTemplate.",q),A.u&&t("Ignoring segment duration because an explicit segment index URL was provided for the SegmentTemplate.",
q),I=qd(q,m)):A.Sa?(A.u&&t("Ignoring segment duration because a SegmentTimeline was provided for the SegmentTemplate.",q),I=rd(this,u,H,q,m)):A.u?I=sd(u,H,q,m):(s("SegmentTemplate does not provide an explicit segment index URL, a SegmentTimeline, or a segment duration.",q),I=!1),A=I):"text"==q.m.split("/")[0]&&(m.N=new N(q.d),A=!0);if(m=A?m:null)g.e.push(m),g.Ya=p,m.f&&0<m.f.length()&&(h=Math.max(h,V(m.f).endTime))}}d.A.push(g);d.duration||(d.duration=h,"dynamic"==a.type&&(d.duration+=2592E3))}this.b.q.push(d)}};
function od(a){if(a.B.length){null==a.B[0].start&&(a.B[0].start=0);var b=function(a){return 0==a||!!a};"static"!=a.type&&(a.ia=null);b(a.ia)&&1==a.B.length&&!b(a.B[0].duration)&&(a.B[0].duration=a.ia);for(var c=0,d=!0,e=0;e<a.B.length;++e){var f=a.B[e-1],g=a.B[e],h=a.B[e+1]||{start:a.ia};!b(g.start)&&f&&b(f.start)&&b(f.duration)&&(g.start=f.start+f.duration);!b(g.duration)&&b(h.start)&&(g.duration=h.start-g.start);null!=g.start&&null!=g.duration?c+=g.duration:d=!1}b(a.ia)?a.ia!=c&&t("@mediaPresentationDuration does not match the total duration of all periods."):
(e=a.B[a.B.length-1],d?a.ia=c:b(e.start)&&b(e.duration)?(t("Some Periods may not have valid start times or durations."),a.ia=e.start+e.duration):"static"==a.type&&(t("Some Periods may not have valid start times or durations; @mediaPresentationDuration may not include the duration of all periods."),a.ia=c))}}
function qd(a,b){var c=a.C,d;if(c.ja){d=td(c.ja,a.id,1,a.bandwidth,0);if(!d)return!1;d=a.d?a.d.resolve(d):d}else d=new N(a.d);var e;var f=a.C;f.La?(e=new hc,(f=td(f.La,a.id,null,a.bandwidth,null))?e.url=a.d&&f?a.d.resolve(f):f:e=null):e=null;if(!e)return!1;f=null;if(c.ua&&(f=ud(a),!f))return!1;b.N=new N(d);c.t&&(b.timestampOffset=-1*c.t/c.o);b.mb=pd(e);b.oa=pd(f);return!0}
function rd(a,b,c,d,e){if(null==c.start)return s("Cannot instantiate SegmentTemplate: the period's start time is unknown.",d),!1;c=d.C;if(!c.ja)return s("Cannot instantiate SegmentTemplate: SegmentTemplate does not have a media URL template.",d),!1;var f;a:{var g=c.Sa.sc,h=0,k=[];for(f=0;f<g.length;++f)for(var m=g[f].repeat||0,p=0;p<=m;++p){if(!g[f].duration){t('SegmentTimeline "S" element does not have a duration.',g[f]);f=null;break a}var q;q=g[f].startTime&&0==p?g[f].startTime:0==f&&0==p?0:h;var u=
q+g[f].duration;0<k.length&&q!=h&&(.03125<=Math.abs((q-h)/c.o)&&t("SegmentTimeline contains a large gap/overlap, the content may have errors in it.",g[f]),k[k.length-1].end=q);h=u;k.push({start:q,end:u})}f=k}if(!f)return!1;g=0;"dynamic"==b.type&&0<f.length&&(g=Math.max(0,f.length-2),g=f[g].start/c.o-(b.ob||0));h=[];for(k=0;k<f.length;++k)if(m=f[k].start,p=m/c.o,q=f[k].end/c.o,!(p<g)){u=td(c.ja,d.id,k+c.W,d.bandwidth,m);if(!u)return!1;u=d.d?d.d.resolve(u):u;h.push(new xc(m,p,q,0,null,new N(u)))}f=
null;if(c.ua&&0<h.length&&(f=ud(d),!f))return!1;c.t&&(e.timestampOffset=-1*c.t/c.o);if("dynamic"==b.type&&0<h.length)for(a=h[h.length-1].startTime-a.b.U,a>=g?x("The best available segment is still available!"):(a=g,x("The best available segment is no longer available.")),k=0;k<h.length;++k)if(h[k].endTime>=a){e.sa=h[k].startTime;break}e.oa=pd(f);e.f=new U(h);w("Generated SegmentIndex from SegmentTimeline",e.f);return!0}
function sd(a,b,c,d){if(null==b.start)return s("Cannot instantiate SegmentTemplate: the period's start time is unknown.",c),!1;var e=c.C;if(!e.ja)return s("Cannot instantiate SegmentTemplate: SegmentTemplate does not have a media URL template.",c),!1;var f=0,g,h;if("dynamic"==a.type){var k;var m=(Date.now()+Fa)/1E3,p=null!=a.Pb?a.Pb:m;if(p>m)t("The stream is not available yet!",b),k=null;else{var q=a.U||0,u=a.Sc||0;k=e.u/e.o;p=m-(p+b.start);0>p?(t("The Period is not available yet!",b),k=null):(m=
p-2*k-a.ob,0>m&&(m=0),m=Math.ceil(m/k)*k,p-=k,0>p?(t("The first segment is not available yet!",b),k=null):(q=Math.floor(p/k)*k-u-q,0>q&&(t("The first segment may not be available yet."),q=0),q=Math.floor(q/k)*k,q>=m?x("The best available segment is still available!"):(q=m,x("The best available segment is no longer available.")),u=m/k+1,k=q/k+1,x("earliestSegmentNumber",u),x("currentSegmentNumber",k),k={Kd:u,current:k}))}k&&(g=k.Kd,h=k.current,f=h-g)}else g=1;k=0;if(0<=g){a:{if("static"==a.type)if(null!=
b.duration)b=b.duration;else{s("Cannot instantiate SegmentTemplate: the Period's duration is unknown.",b);k=null;break a}else b=Math.min(b.duration||Number.POSITIVE_INFINITY,a.zb||Number.POSITIVE_INFINITY,120);k=Math.ceil(b/(e.u/e.o));x("SegmentIndex span",b);x("Optimal SegmentIndex size",k)}if(!k)return!1}b=f+k;f=[];for(k=0;k<b;++k){p=k+g;q=(p-1)*e.u;u=q/e.o;m=(q+e.u)/e.o;p=td(e.ja,c.id,p-1+e.W,c.bandwidth,(p-1+(e.W-1))*e.u);if(!p)return!1;p=c.d?c.d.resolve(p):p;f.push(new xc(q,u,m,0,null,new N(p)))}g=
null;if(e.ua&&0<f.length&&(g=ud(c),!g))return!1;e.t&&(d.timestampOffset=-1*e.t/e.o);"dynamic"==a.type&&0<f.length&&(d.sa=e.u/e.o*(h-1));d.oa=pd(g);d.f=new U(f);w("Generated SegmentIndex from segment duration",d.f);return!0}function ud(a){var b=a.C;if(!b.ua)return null;var c=new ic,b=td(b.ua,a.id,null,a.bandwidth,null);if(!b)return null;c.url=a.d&&b?a.d.resolve(b):b;return c}
function td(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return t('URL template does not have an available substitution for identifier "'+b+'".'),a;"RepresentationID"==b&&c&&(t('URL template should not contain a width specifier for identifier "RepresentationID".'),c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+
1).join("0")+a});try{return new N(a)}catch(g){if(g instanceof URIError)return t("URL template contains an illegal character."),null;throw g;}}function pd(a){if(!a)return null;var b=new hd;b.url=a.url;a.V&&(b.Fa=a.V.Va,b.Za=a.V.end);return b};function vd(a,b,c){K.call(this,a);this.a=b;this.c=c;this.i=this.yb=null;this.g=new G;this.Bb={};this.M=[];this.pd=0;this.Ua=new L;this.Vc=null}r(vd,K);vd.prototype.destroy=function(){this.parent=null;for(var a=0;a<this.M.length;++a)this.M[a].close().catch(function(){});this.M=[];this.Bb=this.i=this.yb=null;this.g.destroy();this.a=this.c=this.g=null};
function wd(a){for(var b=new F,c=a.c.bd(),d=0;d<c.length;++d){var e=c[d];e.Y.keySystem||e.za&&!xd(e.za)||b.push(e.contentType,e)}for(var d={},e=!1,f=0;f<c.length;++f){var g=c[f];if(g.Y.keySystem&&!b.has(g.contentType)){var h=g.Y.keySystem,k=d[h];k||(k=g.Y,k={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:k.Jd?"required":"optional",persistentState:k.Be||a.c.$b()?"required":"optional"},d[h]=k);g.za&&(h=g.contentType+"Capabilities",h in k&&(e=!0,k[h]||(k[h]=
[]),k[h].push({contentType:g.za,robustness:g.Y[g.contentType+"Robustness"]}),v("MKSC",k)))}}if(!e)if(c.length)a.i=c[0].Y;else throw a=Error("No DRM scheme info provided!"),a.type="drm",a;if(0==Object.keys(d).length)return a.c.Qc(b),a.Ua.resolve(),Promise.resolve();e=new L;d=yd(d,e);d=d.then(a.Gd.bind(a,c,b));d=d.then(a.Oe.bind(a));e.reject(null);return d}
function zd(a,b){null==a.Vc&&(a.Vc=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.Ua.reject(a)}.bind(a),b));return a.Ua}function yd(a,b){for(var c in a)(function(c){var e=a[c];b=b.catch(function(){return navigator.requestMediaKeySystemAccess(c,[e])})})(c);return b}l=vd.prototype;
l.Gd=function(a,b,c){for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.has(h)){var k=e[h+"Capabilities"];if(k&&k.length){for(var k=k[0],m=[],p=0;p<a.length;++p){var q=a[p];q.Y.keySystem==d&&q.za==k.contentType&&(m.push(q),this.i=this.i?wb(this.i,q.Y):q.Y)}b.set(h,m)}}}this.c.Qc(b);return c.createMediaKeys(this.i)};
l.Oe=function(a){this.yb=a;return this.a.setMediaKeys(this.yb).then(M(this,function(){if(0<this.c.Tb().length)Ad(this);else{for(var a=0;a<this.i.ha.length;++a){var c=this.i.ha[a];this.qd({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.i.ha.length&&J(this.g,this.a,"encrypted",this.qd.bind(this))}}))};
l.qd=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.Bb[c]){v("onEncrypted_",b,a);try{var d=Bd(this)}catch(e){d=E(e);this.dispatchEvent(d);this.Ua.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.Bb[c]=!0;a.catch(M(this,function(a){if(this.Bb){this.Bb[c]=!1;var b=E(a);this.dispatchEvent(b);this.Ua.reject(a)}}));this.M.push(d)}};
function Ad(a){for(var b=a.c.Tb(),c=0;c<b.length;++c){var d=Bd(a),e=d.load(b[c]);a.M.push(d);e.catch(M(a,function(a){a=E(a);this.dispatchEvent(a)}))}}function Bd(a){var b=a.c.$b()?a.yb.createSession("persistent-license"):a.yb.createSession();J(a.g,b,"message",a.qe.bind(a));J(a.g,b,"keystatuseschange",a.be.bind(a));return b}l.qe=function(a){v("onSessionMessage_",a);Cd(this,a.target,this.i.jd,a.message,this.i.withCredentials,this.i.bc,this.i.Lb,this.i.kid)};
l.be=function(a){v("onKeyStatusChange_",a);a=a.target.keyStatuses.values();for(var b=a.next();!b.done;b=a.next()){var c=Dd[b.value];c&&(c=Error(c),c.type=b.value,b=E(c),this.dispatchEvent(b))}};
function Cd(a,b,c,d,e,f,g,h){var k=null;a.i.kid&&a.i.Lb?(d={token:g,drm_info:Array.apply(null,new Uint8Array(d)),kid:h},k=JSON.stringify(d)):k=d;v("requestLicense_",b,c,k);(new lb(c,k,e,{})).send().then(M(a,function(a){v("onLicenseSuccess_",b);f&&(a=f(a));return b.update(a)})).then(M(a,function(){v("onSessionReady_",b);var a=D({type:"sessionReady",detail:b});this.dispatchEvent(a);this.pd++;this.pd>=this.M.length&&this.Ua.resolve()})).catch(M(a,function(a){a.$e=b;a=E(a);this.dispatchEvent(a)}))}
var Dd={"output-not-allowed":"The required output protection is not available.",expired:"A required key has expired and the content cannot be decrypted.","internal-error":"An unknown error has occurred in the CDM."};function Ed(a,b,c,d,e){K.call(this,a);this.a=b;this.pa=d;this.G=new Uc(c,d,e);this.J=e;this.w=null;this.Wb=0;this.Jb=this.Ab=null;this.v=Fd;this.ra="";this.Ic=!1}r(Ed,K);var Fd=0,Gd=15;Ed.prototype.destroy=function(){this.v=null;this.Ha();this.J=this.w=this.Ab=null;this.G.destroy();this.parent=this.a=this.pa=this.G=null};Ed.prototype.ed=function(){return this.v!=Fd&&1!=this.v};Ed.prototype.Fc=function(){return 4==this.v};
Ed.prototype.start=function(a,b){if(this.v!=Fd)s("Cannot start stream: stream has already been started.");else{v("Starting stream for",a);this.w=a;this.ra=a.m.split("/")[0];this.v=1;this.Wb=b;var c,d=[ed(a),ad(a)];Promise.all(d).then(M(this,function(){var d=Cc(a.f,this.a.currentTime,b);if(!d)return Promise.reject(Error("No segments available."));c=d.kb[0].startTime;x("Fetching segment range",this.ra,d);return this.G.$a(d,a.da,[404,410])})).then(M(this,function(){var b=this.pa.buffered.start(0)-c;
this.v=3;b=D({type:"started",bubbles:!1,Bd:b});this.dispatchEvent(b);Hd(this,a);Id(this)})).catch(M(this,function(a){"aborted"!=a.type&&(this.v=Fd,a=E(a),this.dispatchEvent(a))}))}};l=Ed.prototype;
l.qc=function(a,b){da("switch");da("switch logic");if(this.v==Fd)s("Cannot switch stream: stream has not been started.");else if(1==this.v||2==this.v)v("Waiting to switch streams..."),this.Ab=this.qc.bind(this,a,b);else if(a==this.w)v("Ignoring switch."),this.la();else{v("Switching streams to",a);this.v=2;this.Ha();var c=[ed(a),ad(a),this.G.abort()],d=this.a.paused;b&&this.a.pause();Promise.all(c).then(M(this,function(){var c;if(b)c=this.a.currentTime;else{c=this.J.getBandwidth();var d=a.bandwidth;
c=Math.max(Gd,this.Wb)*d/c;d=Wc(this.G,this.a.currentTime);c=this.a.currentTime+Math.min(c,d-1)}this.w=a;this.ra=a.m.split("/")[0];this.G.reset();c=Cc(a.f,c,Math.max(Gd,this.Wb));if(!c)return Promise.reject(Error("No segments available."));x("Fetching segment range",this.ra,c.kb);ga("switch logic");da("switch fetch");return this.G.$a(c,a.da,[404,410])})).then(M(this,function(){ga("switch fetch");b&&(this.a.currentTime-=.001,d||this.a.play());Hd(this,a);this.v=3;Id(this)})).catch(M(this,function(a){"aborted"!=
a.type&&(a=E(a),this.dispatchEvent(a),this.v=3,this.la())}))}};function Hd(a,b){var c=b.m.split("/")[0],c=D({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Id(a){if(a.Ab){v("Processing deferred switch...");var b=a.Ab;a.Ab=null;b()}else a.la()}
l.Oc=function(){this.v==Fd?s("Cannot resync stream: stream has not been initialized."):1!=this.v&&2!=this.v&&(this.Ha(),this.G.abort().then(M(this,function(){var a=this.a.currentTime,b=this.w.f.find(a);if(0>b)return Jd(this),Promise.resolve();b=this.w.f.get(b);return 0<Wc(this.G,a)&&this.G.Ma[b.id]?Promise.resolve():(this.Ic=!0,this.G.clear())})).then(M(this,function(){this.v=3;this.la()})).catch(M(this,function(a){"aborted"!=a.type&&(a=E(a),this.dispatchEvent(a))})))};l.oc=function(){};l.Ec=function(){return!0};
l.la=function(){this.Ha();var a=this.a.currentTime;if(Wc(this.G,a)>=Math.max(Gd,this.Wb))this.Jb=window.setTimeout(this.la.bind(this),1E3);else if(a=Kd(this,a),0>a||a>=this.w.f.length())Jd(this);else{var b=this.w.f.get(a);x("Fetching segment",this.ra,b);this.G.$a(new Ac([b]),null,[]).then(M(this,function(){x("Added segment",b.id);this.Ic&&0<Wc(this.G,this.a.currentTime)&&(this.Ic=!1,this.a.currentTime+=.001);this.la()})).catch(M(this,function(a){if("aborted"!=a.type){var b=E(a);this.dispatchEvent(b);
b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Te.status)&&(this.Jb=window.setTimeout(this.la.bind(this),5E3))}}))}};function Kd(a,b){for(var c=a.w.f.find(b);0<=c&&c<a.w.f.length();){var d=a.w.f.get(c);if(!a.G.Ma[d.id])break;c++}return c}function Jd(a){if(4!=a.v){w("Stream",a.w.m,"reached EOF.");a.v=4;var b=D({type:"ended"});a.dispatchEvent(b)}}l.Ha=function(){this.Jb&&(window.clearTimeout(this.Jb),this.Jb=null)};function X(a,b){K.call(this,a);this.a=b;this.ea=this.w=null}r(X,K);X.prototype.destroy=function(){this.ea&&this.a.removeChild(this.ea);this.parent=this.a=this.w=this.ea=null};X.prototype.ed=function(){return!0};X.prototype.Fc=function(){return!0};X.prototype.start=function(a){this.w=a;v("Starting stream for",a);a=this.Ec();this.ea&&(this.oc(!1),this.a.removeChild(this.ea));this.ea=document.createElement("track");this.a.appendChild(this.ea);this.ea.src=this.w.N.toString();this.oc(a)};
X.prototype.qc=function(a){this.start(a,0)};X.prototype.Oc=function(){};X.prototype.oc=function(a){this.ea.track.mode=a?"showing":"disabled"};X.prototype.Ec=function(){return this.ea?"showing"==this.ea.track.mode:!1};function Ld(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Md(a){a.playTime+=ha("playing")/1E3}function Nd(a,b){var c=new Od(b);a.streamHistory.push(new Pd(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}
function Od(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.m;this.videoBandwidth=a.bandwidth}function Pd(a){this.timestamp=(Date.now()+Fa)/1E3;this.value=a};function Y(a){K.call(this,null);this.a=a;this.c=null;this.g=new G;this.Ia=null;this.va="en";this.vc=this.hc=null;this.Xa=!1;this.Q=new Ld;this.xc=!0;this.gc=new ub}r(Y,K);n("shaka.player.Player",Y);Y.version="unknown";
Y.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!HTMLVideoElement.prototype.getVideoPlaybackQuality&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!document.body.children};
function xd(a){var b;b="text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a);v(a,b?"is":"is not","supported");return b}Y.isTypeSupported=xd;Y.prototype.destroy=function(){return this.Tc().then(M(this,function(){this.g.destroy();this.a=this.g=null})).catch(function(){})};Y.prototype.destroy=Y.prototype.destroy;
Y.prototype.Tc=function(){if(!this.c)return Promise.resolve();this.Xa&&Qd(this);this.a.pause();Za(this.g);Rd(this);Sd(this);this.Ia.destroy();this.Ia=null;this.a.src="";var a=this.a.setMediaKeys(null);this.c&&(this.c.destroy(),this.c=null);this.Xa=!1;this.Q=new Ld;return a};Y.prototype.unload=Y.prototype.Tc;
Y.prototype.load=function(a){var b=this.Tc();this.a.autoplay&&(da("load"),J(this.g,this.a,"timeupdate",this.$d.bind(this)));a.sb(this.xc);return b.then(M(this,function(){return a.load(this.va)})).then(M(this,function(){this.c=a;this.c.nb(this.gc);this.Ia=new vd(this,this.a,this.c);return wd(this.Ia)})).then(M(this,function(){J(this.g,this.a,"error",this.Kc.bind(this));J(this.g,this.a,"playing",this.le.bind(this));J(this.g,this.a,"pause",this.je.bind(this));return this.c.Xc(this,this.a)})).then(M(this,
function(){Td(this)})).catch(M(this,function(b){a.destroy();this.c=null;this.Ia&&(this.Ia.destroy(),this.Ia=null);var d=E(b);this.dispatchEvent(d);return Promise.reject(b)}))};Y.prototype.load=Y.prototype.load;l=Y.prototype;l.$d=function(){ga("load");this.Q.playbackLatency=ha("load")/1E3;this.g.Ib(this.a,"timeupdate")};
l.Kc=function(a){if(this.a.error){var b=this.a.error.code;b!=MediaError.MEDIA_ERR_ABORTED&&(w("onError_",a,b),a=Error(Ud[b]||"Unknown playback error."),a.type="playback",a=E(a),this.dispatchEvent(a))}else w("Uninterpretable error event!",a)};l.le=function(a){w("onPlaying_",a);da("playing");this.Xa&&Qd(this)};l.je=function(a){w("onPause_",a);ga("playing");Md(this.Q)};
l.getStats=function(){this.a.paused||(ga("playing"),Md(this.Q),da("playing"));var a=this.Q,b=this.a.getVideoPlaybackQuality();b&&(a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.Q};Y.prototype.getStats=Y.prototype.getStats;Y.prototype.Md=function(){var a=this.a.videoWidth,b=this.a.videoHeight;return a&&b?{width:a,height:b}:null};Y.prototype.getCurrentResolution=Y.prototype.Md;Y.prototype.getVideoTracks=function(){return this.c?this.c.getVideoTracks():[]};
Y.prototype.getVideoTracks=Y.prototype.getVideoTracks;Y.prototype.getAudioTracks=function(){return this.c?this.c.getAudioTracks():[]};Y.prototype.getAudioTracks=Y.prototype.getAudioTracks;Y.prototype.Ub=function(){return this.c?this.c.Ub():[]};Y.prototype.getTextTracks=Y.prototype.Ub;Y.prototype.Db=function(a,b){return this.c?this.c.Db(a,void 0==b?!0:b):!1};Y.prototype.selectVideoTrack=Y.prototype.Db;Y.prototype.kc=function(a){return this.c?this.c.kc(a,!1):!1};Y.prototype.selectAudioTrack=Y.prototype.kc;
Y.prototype.lc=function(a){return this.c?this.c.lc(a,!1):!1};Y.prototype.selectTextTrack=Y.prototype.lc;Y.prototype.tb=function(a){this.c&&this.c.tb(a)};Y.prototype.enableTextTrack=Y.prototype.tb;Y.prototype.sb=function(a){this.xc=a;this.c&&this.c.sb(a)};Y.prototype.enableAdaptation=Y.prototype.sb;Y.prototype.Ld=function(){return this.xc};Y.prototype.getAdaptationEnabled=Y.prototype.Ld;Y.prototype.Nd=function(){return this.a.currentTime};Y.prototype.getCurrentTime=Y.prototype.Nd;Y.prototype.Od=function(){return this.a.duration};
Y.prototype.getDuration=Y.prototype.Od;Y.prototype.Pd=function(){return this.a.muted};Y.prototype.getMuted=Y.prototype.Pd;Y.prototype.Sd=function(){return this.a.volume};Y.prototype.getVolume=Y.prototype.Sd;Y.prototype.play=function(){this.vd(1);this.a.play()};Y.prototype.play=Y.prototype.play;Y.prototype.pause=function(){this.a.pause()};Y.prototype.pause=Y.prototype.pause;Y.prototype.requestFullscreen=function(){this.a.requestFullscreen()};Y.prototype.requestFullscreen=Y.prototype.requestFullscreen;
Y.prototype.seek=function(a){this.a.currentTime=a};Y.prototype.seek=Y.prototype.seek;Y.prototype.Me=function(a){Gd=0>a?0:a};Y.prototype.setStreamBufferSize=Y.prototype.Me;Y.prototype.Rd=function(){return Gd};Y.prototype.getStreamBufferSize=Y.prototype.Rd;Y.prototype.He=function(a){Rc=a};Y.prototype.setLicenseRequestTimeout=Y.prototype.He;Y.prototype.Ie=function(a){Qc=a};Y.prototype.setMpdRequestTimeout=Y.prototype.Ie;Y.prototype.Le=function(a){Tc=a};Y.prototype.setRangeRequestTimeout=Y.prototype.Le;
Y.prototype.Je=function(a){this.a.muted=a};Y.prototype.setMuted=Y.prototype.Je;Y.prototype.Ne=function(a){this.a.volume=a};Y.prototype.setVolume=Y.prototype.Ne;Y.prototype.Ke=function(a){this.va=Ua(a)};Y.prototype.setPreferredLanguage=Y.prototype.Ke;Y.prototype.vd=function(a){Sd(this);0<=a?this.a.playbackRate=a:(this.a.playbackRate=0,this.rd(this.a.currentTime,Date.now(),a))};Y.prototype.setPlaybackRate=Y.prototype.vd;
Y.prototype.nb=function(a){if(!(a instanceof ub))throw new TypeError("Argument must be a Restrictions instance.");this.gc=a.clone();this.c&&this.c.nb(this.gc)};Y.prototype.setRestrictions=Y.prototype.nb;Y.prototype.Qd=function(){return this.gc.clone()};Y.prototype.getRestrictions=Y.prototype.Qd;Y.prototype.Zb=function(){return this.c?this.c.Zb():!1};Y.prototype.isLive=Y.prototype.Zb;function Sd(a){a.hc&&(window.clearTimeout(a.hc),a.hc=null)}
function Td(a){Rd(a);a.vc=window.setTimeout(a.we.bind(a),100)}function Rd(a){a.vc&&(window.clearTimeout(a.vc),a.vc=null)}Y.prototype.rd=function(a,b,c){this.a.currentTime=a+(Date.now()-b)/1E3*c;this.hc=window.setTimeout(this.rd.bind(this,a,b,c),100)};function Qd(a){w("Buffering complete.");ga("buffering");var b=a.Q;b.bufferingTime+=ha("buffering")/1E3;a.Xa=!1;a.dispatchEvent(D({type:"bufferingEnd"}))}
Y.prototype.we=function(){Td(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=b-this.a.currentTime,b=b+.05;this.Xa?a>this.c.cd()&&(Qd(this),this.a.play()):b<this.a.duration&&.1>a&&!this.a.paused&&(this.Xa=!0,this.a.pause(),this.Q.bufferingHistory.push((Date.now()+Fa)/1E3),da("buffering"),w("Buffering..."),this.dispatchEvent(D({type:"bufferingStart"})))}};
var Ud={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Vd(){}Vd.prototype.ib=function(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.A.length;++d){for(var e=c.A[d],f=e,g=0;g<f.e.length;++g){var h=f.e[g];xd(gd(h))||(t("Stream uses an unsupported MIME type.",h),f.e.splice(g,1),--g)}0==e.e.length&&(c.A.splice(d,1),--d)}for(b=0;b<a.length;++b)for(c=a[b],d=0;d<c.A.length;++d)c.A[d].e.sort(Wd)};function Wd(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Xd(){this.c=this.J=null;this.g=new G;this.gb=Number.POSITIVE_INFINITY;this.$c=!0}n("shaka.media.SimpleAbrManager",Xd);Xd.prototype.destroy=function(){this.g.destroy();this.c=this.J=this.g=null};Xd.prototype.start=function(a,b){this.J&&this.c||(this.J=a,this.c=b,this.gb=Date.now()+4E3,J(this.g,this.J,"bandwidth",this.Jc.bind(this)),J(this.g,this.c,"adaptation",this.Zd.bind(this)))};Xd.prototype.enable=function(a){this.$c=a};
Xd.prototype.getInitialVideoTrackId=function(){if(!this.c||!this.J)return null;var a=Yd(this);return a?a.id:null};Xd.prototype.Jc=function(){if(this.$c&&!(Date.now()<this.gb)){var a=Yd(this);if(a){if(a.active){this.gb=Date.now()+3E3;return}v("Video adaptation:",a);this.c.Db(a.id,!1)}this.gb=Number.POSITIVE_INFINITY}};Xd.prototype.Zd=function(){this.gb==Number.POSITIVE_INFINITY&&(this.gb=Date.now()+3E4)};
function Yd(a){var b=a.c.getVideoTracks();if(0==b.length)return null;b.sort(la);var c;a:{c=a.c.getAudioTracks();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.J.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth){var h=(f.bandwidth+c)/.95,g=(g.bandwidth+c)/.85;ca("Bandwidth ranges:",((f.bandwidth+c)/1E6).toFixed(3),(h/1E6).toFixed(3),(g/1E6).toFixed(3));if(a>=h&&a<=g&&(d=f,d.active))break}}return d}
;function Zd(a,b,c){K.call(this,null);this.eb=a;this.Ad=b;this.i=c?c:vb();this.qa=null}r(Zd,K);n("shaka.player.HttpVideoSource",Zd);Zd.prototype.destroy=function(){this.qa&&(this.qa.parentElement.removeChild(this.qa),this.qa=null);this.parent=this.i=null};l=Zd.prototype;l.Xc=function(a,b){this.parent=a;var c=b.mediaKeys;b.src=this.eb;c=b.setMediaKeys(c);this.Ad&&(this.qa=document.createElement("track"),this.qa.src=this.Ad,b.appendChild(this.qa),this.qa.track.mode="showing");return c};l.load=function(){return Promise.resolve()};
l.getVideoTracks=function(){return[]};l.getAudioTracks=function(){return[]};l.Ub=function(){return[]};l.cd=function(){return 5};l.bd=function(){var a=new kd;a.Y=this.i;return[a]};l.Qc=function(){};l.Db=function(){return!1};l.kc=function(){return!1};l.lc=function(){return!1};l.tb=function(a){this.qa&&(this.qa.track.mode=a?"showing":"disabled")};l.sb=function(){};l.nb=function(){};l.Tb=function(){return[]};l.$b=function(){return!1};l.Zb=function(){return!1};function Z(a,b,c){K.call(this,null);this.b=a;this.va="";this.Qb=null;this.ca=new MediaSource;this.video=null;this.s={};this.Gb=0;this.Mc=1;this.cc=Number.POSITIVE_INFINITY;this.Ca=Number.NEGATIVE_INFINITY;this.r=new F;this.ga=new G;this.I=null;this.Ob=new L;this.pc=!1;this.T=b;this.Q=null;this.rb=c}r(Z,K);n("shaka.player.StreamVideoSource",Z);
Z.prototype.destroy=function(){this.I&&(this.I.abort(),this.I=null);this.ga.destroy();this.ga=null;this.rb.destroy();this.rb=null;$d(this);this.parent=this.T=this.Ob=this.video=this.ca=this.Qb=this.s=null};l=Z.prototype;
l.Xc=function(a,b){if(!this.b||0==this.b.q.length){var c=Error("Manifest has not been loaded.");c.type="stream";return Promise.reject(c)}this.parent=a;this.video=b;this.Q=a.getStats();J(this.ga,this.ca,"sourceopen",this.de.bind(this));J(this.ga,this.T,"bandwidth",this.Jc.bind(this));c=this.video.mediaKeys;this.video.src=window.URL.createObjectURL(this.ca);c=this.video.setMediaKeys(c);return Promise.all([this.Ob,c])};
l.load=function(a){if(!this.b||0==this.b.q.length)return a=Error("The manifest contains no stream information."),a.type="stream",Promise.reject(a);this.va=a;(new Vd).ib(this.b.q);return 0==this.b.q.length||0==this.b.q[0].A.length?(a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a)):Promise.resolve()};
function ae(a,b){var c=new F;a.b.q.forEach(function(a,b){c.push(a.id||""+b,a)});var d=new F;b.q.forEach(function(a,b){d.push(a.id||""+b,a)});for(var e=c.keys(),f=0;f<e.length;++f){var g=e[f],h=c.get(g);if(1<h.length)t("Cannot update Period "+g+" because more than one existing Period has the same ID.");else{var k=d.get(g);k&&0!=k.length&&(1==k.length?(h[0].duration=k[0].duration,be(a,h[0],k[0])):t("Cannot update Period "+g+" because more than one new Period has the same ID."))}}}
function be(a,b,c){var d=new F;b.A.forEach(function(a,b){d.push(a.id||""+b,a)});var e=new F;c.A.forEach(function(a,b){e.push(a.id||""+b,a)});b=d.keys();for(c=0;c<b.length;++c){var f=b[c],g=d.get(f);if(1<g.length)t("Cannot update StreamSet "+f+" because more than one existing StreamSet has the same ID.");else{var h=e.get(f);h&&0!=h.length&&(1==h.length?ce(a,g[0],h[0]):t("Cannot update StreamSet "+f+" because more than one new StreamSet has the same ID."))}}}
function ce(a,b,c){var d=new F;b.e.forEach(function(a,b){d.push(a.id||""+b,a)});var e=new F;c.e.forEach(function(a,b){e.push(a.id||""+b,a)});c={};for(var f=d.keys(),g=0;g<f.length;++g){var h=f[g];c[h]=h;var k=d.get(h);if(1<k.length)t("Cannot update Stream "+h+" because more than one existing Stream has the same ID.");else{var m=e.get(h);m&&0!=m.length?1==m.length?(h=k[0],m=m[0],h.timestampOffset=m.timestampOffset,h.sa=m.sa,h.oa=m.oa,h.da=null,de(h,m)):t("Cannot update Stream "+h+" because more than one new Stream has the same ID."):
ee(a,b,k[0])}}f=e.keys();for(g=0;g<f.length;++g)h=f[g],c[h]||(c[h]=h,m=e.get(h),1<m.length&&t("Cannot add Stream "+h+" because more than one new Stream has the same ID."),b.e.push(m[0]),v("Added Stream "+h+"."))}
function de(a,b){if(a.f&&b.f){var c=a.f,d=b.f;if(c.pb!=d.pb){var e=c.pb-d.pb;x("Shifting new SegmentReferences by",e,"seconds before merging.");d=new U(Dc(d.h,e))}if(0==c.length())c.h=d.h.slice(0),Bc(c);else if(0==d.length())w("Nothing to merge: new SegmentIndex is empty.");else if(null==V(c).endTime)w("Nothing to merge:","existing SegmentIndex ends at the end of the stream.");else if(null!=V(d).endTime&&V(d).endTime<V(c).endTime)w("Nothing to merge:","new SegmentIndex ends before the existing one ends.");
else{if(V(c).endTime<=d.first().startTime)e=yc(V(c),V(c).startTime,d.first().startTime),e=c.h.slice(0,-1).concat([e]);else{var f;for(f=0;f<c.h.length&&!(c.h[f].endTime>=d.first().startTime);++f);c.h[f].startTime<d.first().startTime?(e=yc(c.h[f],c.h[f].startTime,d.first().startTime),e=c.h.slice(0,f).concat([e])):(c.first().startTime>d.first().startTime||d.first(),e=c.h.slice(0,f))}c.h=e.concat(d.h);Bc(c)}v("Updated StreamInfo "+a.id+", SegmentIndex now has "+a.f.length()+" references.")}else t("A SIDX based SegmentIndex cannot be updated or be used to update an existing SegmentIndex.")}
function ee(a,b,c){var d=a.s[b.contentType];if(d&&d.w==c){a=a.r.get(b.contentType);a:{for(var e=0;e<a.length;++e)for(var f=a[e],g=0;g<f.e.length;++g){var h=f.e[g];if(h!=c&&h.enabled){a=h;break a}}a=null}if(!a){t("Cannot remove stream "+c.id+" because an alternate stream does not exist.");return}d.qc(a,!0)}b.e.splice(b.e.indexOf(c),1);v("Removed Stream "+c.id+".")}
l.getVideoTracks=function(){if(!this.r.has("video"))return[];for(var a=this.s.video,a=(a=a?a.w:null)?a.R:0,b=[],c=this.r.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.e.length;++f){var g=e.e[f];if(g.enabled){var h=g.R,g=new ka(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};
l.getAudioTracks=function(){if(!this.r.has("audio"))return[];for(var a=this.s.audio,a=(a=a?a.w:null)?a.R:0,b=[],c=this.r.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.e.length;++g){var h=e.e[g],k=h.R,h=new ia(k,h.bandwidth,f);k==a&&(h.active=!0);b.push(h)}return b};
l.Ub=function(){if(!this.r.has("text"))return[];for(var a=this.s.text,b=a?a.w:null,b=b?b.R:0,c=[],d=this.r.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.e.length;++h){var k=f.e[h].R,m=new ja(k,g);k==b&&(m.active=!0,m.enabled=a.Ec());c.push(m)}return c};l.cd=function(){return this.b.U||0};l.bd=function(){return 0==this.b.q.length?[]:this.b.q[0].Dc()};
l.Qc=function(a){for(var b={},c=this.b.q[0],d=0;d<c.A.length;++d){var e=c.A[d];b[e.R]=e}this.r.clear();c=a.keys();for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.r.push(e,b[g])}else if("audio"==e)for(var g=f[0].za.split(";")[0],h=0;h<f.length;++h){var k=f[h];k.za.split(";")[0]==g&&this.r.push(e,b[k.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.r.push(e,b[g])}this.pc=!0;if(a=this.r.get("audio"))fe(this,a),this.r.set("audio",a),a=a[0].lang||this.va,Ta(2,this.va,a)&&
(this.pc=!1);if(a=this.r.get("text"))fe(this,a),this.r.set("text",a),a=a[0].lang||this.va,Ta(2,this.va,a)||(this.pc=!1)};l.Db=function(a,b){return ge(this,"video",a,b)};l.kc=function(a,b){return ge(this,"audio",a,b)};l.lc=function(a,b){return ge(this,"text",a,b)};l.tb=function(a){var b=this.s.text;b&&b.oc(a)};l.sb=function(a){this.rb.enable(a)};
l.nb=function(a){this.Qb=a;for(var b=0;b<this.b.q.length;++b)for(var c=this.b.q[b],d=0;d<c.A.length;++d)for(var e=c.A[d],f=0;f<e.e.length;++f){var g=e.e[f];g.enabled=!0;a.maxWidth&&g.width>a.maxWidth&&(g.enabled=!1);a.maxHeight&&g.height>a.maxHeight&&(g.enabled=!1);a.maxBandwidth&&g.bandwidth>a.maxBandwidth&&(g.enabled=!1);a.minBandwidth&&g.bandwidth<a.minBandwidth&&(g.enabled=!1)}};l.Tb=function(){return[]};l.$b=function(){return!1};l.Zb=function(){return this.b?this.b.aa:!1};
function ge(a,b,c,d){if(!a.r.has(b))return!1;for(var e=a.r.get(b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.e.length;++h){var k=g.e[h];if(k.R==c)return Nd(a.Q,k),a.s[b].qc(k,d),!0}return!1}function fe(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(Ta(c,a.va,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.wb){b.splice(d,1);b.splice(0,0,e);break}}
l.de=function(){this.ga.Ib(this.ca,"sourceopen");he(this).then(M(this,function(){this.Ob.resolve()})).catch(M(this,function(a){this.Ob.reject(a)}))};
function he(a){ba(0==Object.keys(a.s).length);if(!ie(a)){if(a.b.aa)return t("Not all streams are available,","will try again after next manifest update..."),Promise.resolve();a=Error("Not all streams are available.");a.type="stream";return Promise.reject(a)}var b=a.b.q[0].duration;null!=b?a.ca.duration=b:t("Manifest does not specify a period duration!");for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.r.has(e)&&b.push(a.r.get(e)[0])}a.Mc=a.video.playbackRate;a.video.playbackRate=
0;a.rb.start(a.T,a);var f=ke(a,b);a.I=new db;a.I.append(function(){var a=[],b;for(b in f)a.push(ed(f[b]));return[Promise.all(a)]}.bind(a));a.I.append(function(){var a;(a=le(this))?(this.b.aa?(this.Gb=a.end,w("Will start streams near the live-edge.")):(this.Gb=a.start,w("Will start streams near the beginning.")),a=!0):a=!1;if(!a){var b=Error("The streams' timelines are disjoint.");b.type="stream";return[Promise.reject(b)]}a:{for(b in f){a=f[b];var c;if("text"==b)c=new X(this,this.video);else b:{c=
a;var d=void 0;try{d=this.ca.addSourceBuffer(gd(c))}catch(e){w("addSourceBuffer() failed",e);c=null;break b}try{d.timestampOffset=c.timestampOffset}catch(q){w("Failed to set timestampOffset",q);c=null;break b}x("timestampOffset",d.timestampOffset);c=new Ed(this,this.video,this.ca,d,this.T)}if(!c){b=Error("Cannot create stream for "+gd(a)+".");b.type="stream";b=Promise.reject(b);break a}this.s[b]=c}b=Promise.resolve()}return[b]}.bind(a));a.I.append(function(){me(this,f);return[Promise.resolve()]}.bind(a));
a.I.start();return a.I.Hb.then(M(a,function(){this.I=null})).catch(M(a,function(a){this.I=null;if("aborted"!=a.type)if($d(this),this.video.playbackRate=this.Mc,this.b.aa)t("Failed to create and start streams,","will try again after next manifest update...");else return Promise.reject(a)}))}
function ke(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=e.e[0];if("video"==e.contentType)for(var g=a.rb.getInitialVideoTrackId(),h=0;h<e.e.length&&(f=e.e[h],f.R!=g);++h);else"audio"==e.contentType&&(f=e.e[Math.floor(e.e.length/2)]);c[e.contentType]=f}return c}function ie(a){a=Ya(a.r);for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.e.length;++d){var e=c.e[d];if(!("text"==e.m.split("/")[0]||null!=e.mb||null!=e.f&&0<e.f.length()))return w("Stream is not available",e),!1}return!0}
function le(a){for(var b=0,c=Number.POSITIVE_INFINITY,d=Ya(a.r),e=0;e<d.length;++e){var f=d[e];if("text"!=f.contentType)for(var g=0;g<f.e.length;++g){var h=f.e[g],k=h.f;k&&0!=k.length()&&(b=Math.max(b,k.first().startTime),null!=h.sa?c=Math.min(c,h.sa):null!=V(k).endTime&&(c=Math.min(c,V(k).endTime)))}}c==Number.POSITIVE_INFINITY&&(a=a.b.q[0].duration,null!=a&&(c=a));return b>c?(t("The streams' timelines are disjoint."),null):{start:b,end:c}}
function me(a,b){a.sd(b);v("Starting each stream from",a.Gb);var c=a.Gb;a.video.currentTime!=a.Gb&&a.video.addEventListener("loadedmetadata",function(){this.currentTime=c},!0);for(var d in a.s){var e=a.s[d];J(a.ga,e,"started",a.ue.bind(a));J(a.ga,e,"ended",a.te.bind(a));var f=b[d];Nd(a.Q,f);e.start(f,a.b.U)}a.tb(a.pc)}function $d(a){for(var b in a.s)a.s[b].destroy();a.s={}}l.sd=function(){};
l.ue=function(a){x("onStreamStarted_",a);this.cc=Math.min(this.cc,a.Bd);this.Ca=Math.max(this.Ca,a.Bd);for(var b in this.s)if(!this.s[b].ed())return;v("min/max timestamp corrections",[this.cc,this.Ca]);if(0<=this.cc*this.Ca)for(a=Ya(this.r),b=0;b<a.length;++b){var c=a[b];if("text"!=c.contentType)for(var d=0;d<c.e.length;++d){var e=c.e[d],f=e.f;if(f){var g=this.Ca;f.pb+=g;f.h=Dc(f.h,g);Bc(f)}null!=e.sa&&(e.sa+=this.Ca)}}else t("Some streams' media timestamps are ahead of their SegmentIndexes,","while other streams' are behind.",
"The content may have errors in it.");this.Lc()};l.Lc=function(){w("Adjusting video.currentTime by",this.Ca,"seconds.");this.video.currentTime+=this.Ca;this.video.playbackRate=this.Mc;var a=function(){x("Ignoring first 'seeking' event.");this.video.removeEventListener("seeking",a);J(this.ga,this.video,"seeking",this.pe.bind(this))}.bind(this);this.video.addEventListener("seeking",a)};
l.te=function(a){x("onStreamEnded_",a);if(!this.b.aa){for(var b in this.s)if(!this.s[b].Fc())return;"open"==this.ca.readyState&&this.ca.endOfStream()}};l.pe=function(){this.dc()};l.dc=function(){for(var a in this.s)this.s[a].Oc()};l.Jc=function(){var a=this.Q,b=this.T.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new Pd(b))};function ne(a,b,c,d){c||(c=new bb);d||(d=new Xd);Z.call(this,null,c,d);this.md=a;this.fb=null;this.bb=b;this.vb=this.rc=null;this.ac=new Ra(5);this.Kb=null;this.K=this.H=this.Xb=this.Yb=this.tc=0;this.Rc=!1;this.ic=null}r(ne,Z);n("shaka.player.DashVideoSource",ne);ne.prototype.destroy=function(){this.Ha();oe(this);this.ac=this.bb=null;Z.prototype.destroy.call(this)};l=ne.prototype;
l.load=function(a){this.vb=Date.now()/1E3;return(new Pc(this.md)).send().then(M(this,function(b){var c=new nd(this.bb);c.ib(b);this.fb=b;this.tc=b.ob||0;this.b=c.b;b=Z.prototype.load.call(this,a);this.b.aa&&b.then(M(this,function(){pe(this);qe(this)}));return b}))};l.sd=function(){var a=le(this);a&&(this.Yb=this.b.aa?Math.max(a.end-this.tc,a.start):a.start,this.Xb=a.end,v("Initial seek range",[this.Yb,this.Xb]),this.H=this.Yb,this.K=this.Xb,this.b.aa&&(re(this),se(this)))};
l.Lc=function(){var a=le(this);if(a){var b=this.K-this.Xb;this.H=a.start+(this.H-this.Yb);this.K=a.end+b;v("Corrected seek range",[this.H,this.K])}Z.prototype.Lc.call(this);this.Rc=!0;te(this);J(this.ga,this.video,"play",this.ke.bind(this))};l.dc=function(){var a=this.video.currentTime;a>=this.H-.01&&a<=this.K+.01?Z.prototype.dc.call(this):(t("Cannot seek outside of seekable range:","seekable",[this.H,this.K],"attempted",this.video.currentTime),this.video.currentTime=a<this.H?this.H:this.K)};
l.ke=function(a){x("onPlay_",a);this.dc()};
l.la=function(){this.Ha();var a=Date.now()/1E3;this.vb=a;null==this.fb.zb?a=Promise.resolve():(w("Requesting new MPD... last MPD was retrieved",a-this.vb,"seconds ago."),a=(new Pc(this.md)).send().then(M(this,function(a){this.fb=a})));a.then(M(this,function(){var a=new nd(this.bb);a.ib(this.fb);this.tc=this.fb.ob||0;a=a.b;w("Updating manifest...");if(this.b&&0!=this.b.q.length){if(this.b.U=a.U,(new Vd).ib(a.q),ae(this,a),this.Qb&&this.nb(this.Qb),this.video&&!this.I)if(0==Object.keys(this.s).length)he(this);
else if(this.b.aa)for(var c in this.s)a=this.s[c],a.Fc()&&(w("Resyncing ended stream."),a.Oc())}else c=Error("Manifest has not been loaded."),c.type="stream",c=E(c),this.dispatchEvent(c);for(c=0;c<this.b.q.length;++c)for(var a=this.b.q[c],d=0;d<a.A.length;++d)for(var e=a.A[d],f=0;f<e.e.length;++f){var g=e.e[f];if(g.f){var h=g.f.length(),k=g.f,m=this.H;0!=k.h.length&&(V(k).endTime<=m?k.h=[]:(m=k.find(m),k.h=k.h.slice(m)));g=g.f.length();v("Evicted",h-g,"reference(s).")}}pe(this);qe(this);re(this)})).catch(M(this,
function(a){this.ac&&(a=E(a),this.dispatchEvent(a),qe(this),re(this))}))};function qe(a){var b=Math.max(a.fb.zb||0,3);w("updateInterval",b);a.Kb=window.setTimeout(a.la.bind(a),1E3*b)}function re(a){for(var b=0,c=0;c<a.b.q.length;++c)for(var d=a.b.q[c],e=0;e<d.A.length;++e)for(var f=d.A[e],g=0;g<f.e.length;++g){var h=f.e[g].f;if(h&&0!=h.length())var k=Math.max(0,h.length()-2),h=h.get(k),b=Math.max(b,h.startTime)}a.rc=b-Sa(a.ac)-1;w("targetUpdateTime_",a.rc)}
l.oe=function(a){oe(this);a=(Date.now()-a)/1E3;this.K-this.H+a>=this.tc&&(this.H+=a);this.Rc?this.K+=a:1>=this.K-this.H&&(t("The seek start time has overtaken the seek end time!"),this.K=this.H+1);null!=this.rc&&this.K>=this.rc&&(a=Date.now()/1E3-this.vb,null!=this.Kb&&3<=a&&this.la());this.Rc&&te(this);se(this)};function te(a){var b=D({type:"seekrangechanged",bubbles:!0,start:a.H,end:a.K});a.dispatchEvent(b)}function se(a){a.ic=window.setTimeout(a.oe.bind(a,Date.now()),1E3)}
l.Ha=function(){this.Kb&&(window.clearTimeout(this.Kb),this.Kb=null)};function oe(a){a.ic&&(window.clearTimeout(a.ic),a.ic=null)}function pe(a){a.ac.sample(1,Date.now()/1E3-a.vb)};function Kc(a,b){K.call(this,b);this.ya=null;this.J=a}r(Kc,K);
function Lc(a){if(!window.indexedDB)return Promise.reject(Error("Offline storage requires IndexedDB support."));var b=new L,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=M(a,function(a){this.ya=a.target.result;ue(this,"group_store",{keyPath:"group_id"});ue(this,"stream_index_store",{keyPath:"stream_id"});a=ue(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=M(a,
function(a){this.ya=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function W(a){a.ya&&a.ya.close()}function ue(a,b,c){a.ya.objectStoreNames.contains(b)&&a.ya.deleteObjectStore(b);return a.ya.createObjectStore(b,c)}
function ve(a,b,c,d,e){for(var f=[],g=0,h=0,k=Promise.resolve(),m=0;m<b.length;++m)var p=b[m],q=[ed(p),ad(p)],k=k.then(function(a){return Promise.all(a)}.bind(a,q)).then(function(a){g+=a.f.length()}.bind(a,p));for(m=0;m<b.length;++m)p=b[m],k=k.then(function(a){return we(this,a,g,h)}.bind(a,p)),k=k.then(function(a,b){h+=a.f.length();f.push(b)}.bind(a,p));return k.then(M(a,function(){return xe(ye(this))})).then(M(a,function(a){var b=new L,g={group_id:a,stream_ids:f,session_ids:c,duration:d,key_system:e.keySystem},
h=ye(this).put(g);h.onsuccess=function(){b.resolve(a)};h.onerror=function(){b.reject(h.error)};return b}))}function we(a,b,c,d){var e=[xe(ze(a)),xe(Ae(a).index("stream"))],e=Promise.all(e).then(M(a,function(a){return{Fb:Math.max(a[0],a[1]),lb:new ArrayBuffer(0),jc:0,kb:[],Cc:null,Re:c,td:d}})),e=e.then(a.Td.bind(a,b));return e=e.then(a.Ud.bind(a,b))}
function xe(a){var b=new L,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}l=Kc.prototype;l.Ud=function(a,b){var c=new L,d={stream_id:b.Fb,mime_type:a.m,codecs:a.X,init_segment:a.da,references:b.kb},e=ze(this).put(d);e.onsuccess=function(){c.resolve(b.Fb)};e.onerror=function(){c.reject(e.error)};return c};
l.Td=function(a,b){for(var c=a.f,d=Promise.resolve(),e=0;e<c.length();++e)var f=c.get(e),g=this.Fd.bind(this,f,b),d=d.then(this.De.bind(this,f)),d=d.then(g);return d.then(function(){return Promise.resolve(b)}).catch(M(this,function(a){Be(this,b.Fb);return Promise.reject(a)}))};
l.Fd=function(a,b,c){var d=new L;0==b.lb.byteLength&&(b.Cc=a);b.lb=Ce(b.lb,c);b.td++;var e=D({type:"progress",detail:b.td/b.Re*100,bubbles:!0});if(1048576<=b.lb.byteLength||null==a.endTime){c={stream_id:b.Fb,segment_id:b.jc,content:b.lb};var f=Ae(this).put(c);b.kb.push({index:b.jc,start_time:b.Cc.startTime,start_byte:b.Cc.Fa,end_time:a.endTime,url:"idb://"+b.Fb+"/"+b.jc});b.jc++;b.lb=new ArrayBuffer(0);f.onerror=function(){d.reject(f.error)};f.onsuccess=M(this,function(){this.dispatchEvent(e);d.resolve()})}else this.dispatchEvent(e),
d.resolve();return d};function Ce(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}l.De=function(a){a=new Sc(a.url.toString(),a.Fa,a.Za);a.T=this.J;return a.send()};function Mc(a,b,c){return De(Ae(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})}function Ee(a,b){return De(ze(a),b)}
function Fe(a,b){return De(ye(a),b).then(function(a){return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Ee(this,a.af[0]).then(function(b){a.duration=b.duration;a.Vd=b.Vd;return Promise.resolve(a)})}.bind(a))}function Ge(a){var b=new L,c=[],d=ye(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function De(a,b){var c=new L,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c}
function Be(a,b){var c=new L,d=ze(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Ae(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c}l.zc=function(a){return Fe(this,a).then(M(this,function(b){var c=[],d;for(d in b.stream_ids)c.push(Be(this,b.stream_ids[d]));b=ye(this);c.push(b.delete(a));return Promise.all(c)}))};
function Ae(a){return He(a,"content_store")}function ze(a){return He(a,"stream_index_store")}function ye(a){return He(a,"group_store")}function He(a,b){return a.ya.transaction([b],"readwrite").objectStore(b)};function $(a,b,c){b||(b=new bb);c||(c=new Xd);Z.call(this,null,b,c);this.dd=a;this.nc=[];this.timeoutMs=3E4}r($,Z);n("shaka.player.OfflineVideoSource",$);$.retrieveGroupIds=function(){var a=new Kc(null,null),b=Lc(a).then(function(){return Ge(a)});b.then(function(){W(a)}).catch(function(){W(a)});return b};
$.prototype.Pe=function(a,b,c,d){var e,f,g;a=new Pc(a);var h=Ua(b);return a.send().then(M(this,function(a){var b=new nd(c);b.ib(a);this.b=b.b;return this.b.aa?Promise.reject(Error("Unable to store live streams offline.")):Z.prototype.load.call(this,h)})).then(M(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.ca);e=new vd(null,a,this);J(this.ga,e,"sessionReady",this.re.bind(this));return wd(e)})).then(M(this,function(){g={};for(var a=Ya(this.r),b=0;b<a.length;++b)for(var c=
a[b],e=0;e<c.e.length;++e){var f=c.e[e];g[f.R]=f}return d()})).then(M(this,function(a){f=[];for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)f.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}a=[];for(b=0;b<f.length;++b)a.push(ad(f[b]));return Promise.all(a)})).then(M(this,function(){var a=["audio","video"];f=f.filter(function(b){return 0>a.indexOf(b.m.split("/")[0])?(t("Ignoring track ID "+b.R+" due to unsupported type: "+b.m.split("/")[0]),!1):!0});return Ie(this,f)})).then(M(this,
function(){return zd(e,this.timeoutMs)})).then(M(this,function(){var a=e.i,b=this.b.q[0].duration;b||t("The duration of the stream being stored is null.");return Je(this,f,a,b)}))};$.prototype.store=$.prototype.Pe;
function Ie(a,b){for(var c=[],d=0;d<b.length;++d)try{c[d]=a.ca.addSourceBuffer(gd(b[d]))}catch(e){s("addSourceBuffer() failed",e)}if(b.length!=c.length)return c=Error("Error initializing streams."),c.type="storage",Promise.reject(c);for(d=0;d<b.length;++d)c[d].appendBuffer(b[d].da);return Promise.resolve()}$.prototype.re=function(a){this.nc.push(a.detail.sessionId)};
function Je(a,b,c,d){var e=new Kc(a.T,a),f=Lc(e);return f=f.then(M(a,function(){return ve(e,b,this.nc,d,c)})).then(function(a){W(e);return Promise.resolve(a)}).catch(function(a){W(e);return Promise.reject(a)})}
$.prototype.load=function(a){var b=new Kc(null,null),c;return Lc(b).then(M(this,function(){return Fe(b,this.dd)})).then(M(this,function(a){var e=[];this.nc=a.session_ids;c=a.duration;for(var f=0;f<a.stream_ids.length;++f)e.push(Ee(b,a.stream_ids[f]));return Promise.all(e)})).then(M(this,function(b){var e=c,f=new md;f.U=5;for(var g=new ld,h=0;h<b.length;++h){for(var k=b[h],m=[],p=0;p<k.references.length;p++){var q=k.references[p],q=new xc(q.index,q.start_time,q.end_time,q.start_byte,null,new N(q.url));
m.push(q)}p=new Zc;m=new U(m);p.f=m;p.m=k.mime_type;p.X=k.codecs;p.da=k.init_segment;k=new rb(k.key_system,"",!1,null,null,"","");m=new id;m.e.push(p);m.Ya.push(k);m.contentType=p.m.split("/")[0];g.A.push(m);g.duration=e}f.q.push(g);this.b=f;return Z.prototype.load.call(this,a)})).then(function(){W(b);return Promise.resolve()}).catch(function(a){W(b);return Promise.reject(a)})};
$.prototype.zc=function(){var a=new Kc(null,null);return Lc(a).then(a.zc.bind(a,this.dd)).then(function(){W(a);return Promise.resolve()}).catch(function(b){W(a);return Promise.reject(b)})};$.prototype.deleteGroup=$.prototype.zc;$.prototype.Tb=function(){return this.nc};$.prototype.$b=function(){return!0};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined")define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

//# sourceMappingURL=shaka-player.compiled.debug.map
